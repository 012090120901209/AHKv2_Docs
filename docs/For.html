<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For-loop | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Repeats one or more [statements](../Concepts.htm#statement) once for">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/guides/Tutorial.html">Tutorial</a></li>
                            <li><a href="/guides/FAQ.html">FAQ</a></li>
                            <li><a href="/guides/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/functions/string/">String Functions</a></li>
                            <li><a href="/functions/window/">Window Functions</a></li>
                            <li><a href="/functions/file/">File Operations</a></li>
                            <li><a href="/functions/system/">System Functions</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/objects/Array.html">Array</a></li>
                            <li><a href="/objects/Map.html">Map</a></li>
                            <li><a href="/objects/Object.html">Object</a></li>
                            <li><a href="/objects/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/directives/_Include.html">#Include</a></li>
                            <li><a href="/directives/_Requires.html">#Requires</a></li>
                            <li><a href="/directives/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/reference/KeyList.html">Key List</a></li>
                            <li><a href="/reference/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/reference/Variables.html">Variables</a></li>
                            <li><a href="/reference/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>For</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="for-loop">For-loop</h1>
<p>Repeats one or more <a href="../Concepts.htm#statement">statements</a> once for
each key-value pair in an object.</p>
<pre class="codehilite"><code class="language-Syntax">For Value1 , Value2 in Expression
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>Value1, Value2</dt>
<dd>
<p>Type: <a href="../Concepts.htm#variables">Variable</a></p>
<p>The variables in which to store the values returned by the
enumerator at the beginning of each iteration. The nature of these
values is defined by the enumerator, which is determined by
<em>Expression</em>. These variables cannot be
<a href="../Language.htm#dynamic-variables">dynamic</a>.</p>
<p>When the loop breaks or completes, these variables are restored to
their former values. If a loop variable is a <a href="../Functions.htm#ByRef">ByRef
parameter</a>, the target variable is
unaffected by the loop. <a href="../Functions.htm#closures">Closures</a> which
reference the variable (if local) are also unaffected and will see
only the value it had outside the loop.</p>
<p><strong>Note:</strong> Even if defined inside the loop body, a nested function
which refers to a loop variable cannot see or change the current
iteration\'s value. Instead, pass the variable explicitly or
<a href="Func.htm#Bind">bind</a> its value to a parameter.</p>
<p>Up to 19 variables are supported, if supported by the enumerator.</p>
<p>Variables can be omitted. For example, <code>for , value in myMap</code> calls
<em>myMap</em>\'s enumerator with only its second parameter, omitting its
first parameter. If the enumerator is user-defined and the parameter
is mandatory, an exception is thrown as usual. The parameter count
passed to <a href="../Objects.htm#__Enum">__Enum</a> is 0 if there are no
variables or commas; otherwise it is 1 plus the number of commas
present.</p>
</dd>
<dt>Expression</dt>
<dd>
<p>Type: <a href="../Concepts.htm#objects">Object</a></p>
<p>An <a href="../Variables.htm#Expressions">expression</a> which results in an
enumerable object, or a variable which contains an enumerable
object.</p>
</dd>
</dl>
<h2 id="Remarks">Remarks</h2>
<p>The parameter list can optionally be enclosed in parentheses. For
example: <code>for (val in myarray)</code></p>
<p>The process of enumeration is as follows:</p>
<ul>
<li>Before the loop begins, <em>Expression</em> is evaluated to determine the
    target object.</li>
<li>The object\'s <code>__Enum</code> method is called to retrieve an
    <a href="Enumerator.htm"><em>enumerator</em></a> object. If no such method exists, the
    object itself is assumed to be an enumerator object.</li>
<li>At the beginning of each iteration, the enumerator is
    <a href="Enumerator.htm#Call">called</a> to retrieve the next value or pair of
    values. If it returns false (zero or an empty string), the loop
    terminates.</li>
</ul>
<p>Although not exactly equivalent to a for-loop, the following
demonstrates this process:</p>
<pre class="codehilite"><code>_enum := Expression
try _enum := _enum.__Enum(2)
while _enum(&amp;Value1, &amp;Value2)
{
    ...
}
</code></pre>

<p>As in the code above, an exception is thrown if <em>Expression</em> or __Enum
yields a value which cannot be called.</p>
<p>While enumerating properties, methods or array elements, it is generally
unsafe to insert or remove items of that type. Doing so may cause some
items to be skipped or enumerated multiple times. One workaround is to
build a list of items to remove, then use a second loop to remove the
items after the first loop completes.</p>
<p>A for-loop is usually followed by a <a href="Block.htm">block</a>, which is a
collection of statements that form the <em>body</em> of the loop. However, a
loop with only a single statement does not require a block (an \"if\"
and its \"else\" count as a single statement for this purpose). The One
True Brace (OTB) style may optionally be used, which allows the
open-brace to appear on the same line rather than underneath. For
example: <code>for x, y in z {</code>.</p>
<p>As with all loops, <a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a> and
<a href="../Variables.htm#Index">A_Index</a> may be used.</p>
<p>The loop may optionally be followed by an <a href="Else.htm">Else</a> statement,
which is executed if the loop had zero iterations.</p>
<h2 id="COM_Objects">COM Objects</h2>
<p>Since <em>Value1</em> and <em>Value2</em> are passed directly to the enumerator, the
values they are assigned depends on what type of object is being
enumerated. For COM objects, <em>Value1</em> contains the value returned by
<a href="https://learn.microsoft.com/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next">IEnumVARIANT::Next()</a>
and <em>Value2</em> contains a number which represents its <a href="https://learn.microsoft.com/openspecs/windows_protocols/ms-oaut/3fe7db9f-5803-4dc4-9d14-5425d3f5461f">variant
type</a>.
For example, when used with a
<a href="https://learn.microsoft.com/previous-versions/x4k5wbx4(v=vs.85)">Scripting.Dictionary</a>
object, each <em>Value1</em> contains a key from the dictionary and <em>Value2</em> is
typically 8 for strings and 3 for integers. See
<a href="ComObjType.htm">ComObjType</a> for a list of type codes.</p>
<p>When enumerating a <a href="ComObjArray.htm">SafeArray</a>, <em>Value1</em> contains the
current element and <em>Value2</em> contains its variant type.</p>
<h2 id="Related">Related</h2>
<p><a href="Enumerator.htm">Enumerator object</a>, <a href="Object.htm#OwnProps">OwnProps</a>,
<a href="While.htm">While-loop</a>, <a href="Loop.htm">Loop</a>, <a href="Until.htm">Until</a>,
<a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a>, <a href="Block.htm">Blocks</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExBasic .ex}
<a class="ex_number" href="#ExBasic"></a> Lists the properties owned by an object.</p>
<pre class="codehilite"><code>colours := {red: 0xFF0000, blue: 0x0000FF, green: 0x00FF00}
; The above expression could be used directly in place of &quot;colours&quot; below:
s := &quot;&quot;
for k, v in colours.OwnProps()
    s .= k &quot;=&quot; v &quot;`n&quot;
MsgBox s
</code></pre>

<p>:::</p>
<p>::: {#ExCOM .ex}
<a class="ex_number" href="#ExCOM"></a> Lists all open Explorer and Internet Explorer
windows, using the
<a href="https://learn.microsoft.com/windows/win32/shell/shell">Shell</a> object.</p>
<pre class="codehilite"><code>windows := &quot;&quot;
for window in ComObject(&quot;Shell.Application&quot;).Windows
    windows .= window.LocationName &quot; :: &quot; window.LocationURL &quot;`n&quot;
MsgBox windows
</code></pre>

<p>:::</p>
<p>::: {#ExFibF .ex}
<a class="ex_number" href="#ExFibF"></a> Defines an enumerator as a <a href="../Variables.htm#fat-arrow">fat arrow
function</a>. Returns numbers from the
Fibonacci sequence, indefinitely or until stopped.</p>
<pre class="codehilite"><code>for n in FibF()
    if MsgBox(&quot;#&quot; A_Index &quot; = &quot; n &quot;`nContinue?&quot;,, &quot;y/n&quot;) = &quot;No&quot;
        break

FibF() {
    a := 0, b := 1
    return (&amp;n) =&gt; (
        n := c := b, b += a, a := c,
        true
    )
}
</code></pre>

<p>:::</p>
<p>::: {#ExFibC .ex}
<a class="ex_number" href="#ExFibC"></a> Defines an enumerator as a
<a href="../Objects.htm#Custom_Classes">class</a>. Equivalent to the <a href="#ExFibF">previous
example</a>.</p>
<pre class="codehilite"><code>for n in FibC()
    if MsgBox(&quot;#&quot; A_Index &quot; = &quot; n &quot;`nContinue?&quot;,, &quot;y/n&quot;) = &quot;No&quot;
        break

class FibC {
    a := 0, b := 1
    Call(&amp;n) {
        n := c := this.b, this.b += this.a, this.a := c
        return true
    }
}
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/For.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#for-loop">For-loop</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#COM_Objects">COM Objects</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/theme.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/syntax.js"></script>
</body>
</html>