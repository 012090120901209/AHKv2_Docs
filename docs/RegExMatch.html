<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RegExMatch | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Determines whether a string contains a pattern (regular expression).">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/guides/Tutorial.html">Tutorial</a></li>
                            <li><a href="/guides/FAQ.html">FAQ</a></li>
                            <li><a href="/guides/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/functions/string/">String Functions</a></li>
                            <li><a href="/functions/window/">Window Functions</a></li>
                            <li><a href="/functions/file/">File Operations</a></li>
                            <li><a href="/functions/system/">System Functions</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/objects/Array.html">Array</a></li>
                            <li><a href="/objects/Map.html">Map</a></li>
                            <li><a href="/objects/Object.html">Object</a></li>
                            <li><a href="/objects/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/directives/_Include.html">#Include</a></li>
                            <li><a href="/directives/_Requires.html">#Requires</a></li>
                            <li><a href="/directives/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/reference/KeyList.html">Key List</a></li>
                            <li><a href="/reference/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/reference/Variables.html">Variables</a></li>
                            <li><a href="/reference/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>RegExMatch</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="regexmatch">RegExMatch</h1>
<p>Determines whether a string contains a pattern (regular expression).</p>
<pre class="codehilite"><code class="language-Syntax">FoundPos := RegExMatch(Haystack, NeedleRegEx , &amp;OutputVar, StartingPos)
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>Haystack</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The string whose content is searched. This may contain binary zero.</p>
</dd>
<dt>NeedleRegEx</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The pattern to search for, which is a Perl-compatible regular
expression (PCRE). The pattern\'s
<a href="../misc/RegEx-QuickRef.htm#Options">options</a> (if any) must be
included at the beginning of the string followed by a
close-parenthesis. For example, the pattern
[[i)]{.red}abc.*123]{.regex} would turn on the case-insensitive
option and search for \"abc\", followed by zero or more occurrences
of any character, followed by \"123\". If there are no options, the
\")\" is optional; for example, [)abc]{.regex} is equivalent to
[abc]{.regex}.</p>
<p>Although <em>NeedleRegEx</em> cannot contain binary zero, the pattern
<code>\x00</code> can be used to match a binary zero within <em>Haystack</em>.</p>
</dd>
<dt>&amp;OutputVar</dt>
<dd>
<p>Type: <a href="../Concepts.htm#variable-references">VarRef</a></p>
<p>If omitted, no output variable will be used. Otherwise, specify a
reference to the output variable in which to store a <a href="#MatchObject">match
object</a>, which can be used to retrieve the position,
length and value of the overall match and of each <a href="../misc/RegEx-QuickRef.htm#subpat">captured
subpattern</a>, if any are present.</p>
<p>If the pattern is not found (that is, if the function returns 0),
this variable is made blank.</p>
</dd>
<dt>StartingPos</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 1 (the beginning of <em>Haystack</em>).
Otherwise, specify 2 to start at the second character, 3 to start at
the third, and so on. If <em>StartingPos</em> is beyond the length of
<em>Haystack</em>, the search starts at the empty string that lies at the
end of <em>Haystack</em> (which typically results in no match).</p>
<p>Specify a negative <em>StartingPos</em> to start at that position from the
right. For example, -1 starts at the last character and -2 starts at
the next-to-last character. If <em>StartingPos</em> tries to go beyond the
left end of <em>Haystack</em>, all of <em>Haystack</em> is searched.</p>
<p>Specify 0 to start at the end of <em>Haystack</em>; i.e. the position to
the right of the last character. This can be used with zero-width
assertions such as <code>(?&lt;=a)</code>.</p>
<p>Regardless of the value of <em>StartingPos</em>, the return value is always
relative to the first character of <em>Haystack</em>. For example, the
position of \"abc\" in \"123abc789\" is always 4.</p>
</dd>
</dl>
<h2 id="Return_Value">Return Value</h2>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This function returns the position of the leftmost occurrence of
<em>NeedleRegEx</em> in the string <em>Haystack</em>. Position 1 is the first
character. Zero is returned if the pattern is not found.</p>
<h2 id="Errors">Errors</h2>
<p><strong>Syntax errors:</strong> If the pattern contains a syntax error, an
<a href="Error.htm">Error</a> is thrown with a message in the following form:
<em>Compile error N at offset M: description</em>. In that string, <em>N</em> is the
PCRE error number, <em>M</em> is the position of the offending character inside
the regular expression, and <em>description</em> is the text describing the
error.</p>
<p><strong>Execution errors:</strong> If an error occurs during the <em>execution</em> of the
regular expression, an <a href="Error.htm">Error</a> is thrown. The <em>Extra</em>
property of the error object contains the PCRE error number. Although
such errors are rare, the ones most likely to occur are \"too many
possible empty-string matches\" (-22), \"recursion too deep\" (-21), and
\"reached match limit\" (-8). If these happen, try to redesign the
pattern to be more restrictive, such as replacing each * with a ?, +,
or a limit like {0,3} wherever feasible.</p>
<h2 id="Options">Options</h2>
<p>See <a href="../misc/RegEx-QuickRef.htm#Options">RegEx Quick Reference</a> for
options such as [[i)]{.red}abc]{.regex}, which turns off
case-sensitivity.</p>
<h2 id="MatchObject">Match Object (RegExMatchInfo)</h2>
<p>If a match is found, an object containing information about the match is
stored in <em>OutputVar</em>. This object has the following methods and
properties:</p>
<p><strong>Match.Pos</strong>, <strong>Match.Pos[N]</strong> or <strong>Match.Pos(N)</strong>: Returns the
position of the overall match or a captured subpattern.</p>
<p><strong>Match.Len</strong>, <strong>Match.Len[N]</strong> or <strong>Match.Len(N)</strong>: Returns the
length of the overall match or a captured subpattern.</p>
<p><strong>Match.Name[N]</strong> or <strong>Match.Name(N)</strong>: Returns the name of the given
subpattern, if it has one.</p>
<p><strong>Match.Count:</strong> Returns the overall number of subpatterns (capturing
groups), which is also the maximum value for <em>N</em>.</p>
<p><strong>Match.Mark:</strong> Returns the <em>NAME</em> of the last encountered
[(*MARK:NAME)]{.regex}, when applicable.</p>
<p><strong>Match[]</strong> or <strong>Match[N]</strong>: Returns the overall match or a captured
subpattern.</p>
<p>All of the above allow <em>N</em> to be any of the following:</p>
<ul>
<li>0 for the overall match.</li>
<li>The number of a subpattern, even one that also has a name.</li>
<li>The name of a subpattern.</li>
</ul>
<p><strong>Match.N:</strong> Shorthand for <strong>Match[\"N\"]</strong>, where <em>N</em> is any unquoted
name or number which does not conflict with a defined property (listed
above). For example, <code>match.1</code> or <code>match.Year</code>.</p>
<p>The object also supports enumeration; that is, the <a href="For.htm">for-loop</a>
is supported. Alternatively, use <a href="Loop.htm"><code>Loop</code></a><code>Match.Count</code>.</p>
<h2 id="Performance">Performance</h2>
<p>To search for a simple substring inside a larger string, use
<a href="InStr.htm">InStr</a> because it is faster than RegExMatch.</p>
<p>To improve performance, the 100 most recently used regular expressions
are kept cached in memory (in compiled form).</p>
<p>The <a href="../misc/RegEx-QuickRef.htm#Study">study option (S)</a> can sometimes
improve the performance of a regular expression that is used many times
(such as in a loop).</p>
<h2 id="Remarks">Remarks</h2>
<p>A subpattern may be given a name such as the word <em>Year</em> in the pattern
[(?P\&lt;Year&gt;\d{4})]{.regex}. Such names may consist of up to 32
alphanumeric characters and underscores. Note that named subpatterns are
also numbered, so if an <a href="../misc/RegEx-QuickRef.htm#subpat">unnamed
subpattern</a> occurs after \"Year\", it
would be stored in <code>OutputVar[2]</code>, not <code>OutputVar[1]</code>.</p>
<p>Most characters like abc123 can be used literally inside a regular
expression. However, any of the characters in the set <code>\.*?+[{|()^$</code>
must be preceded by a backslash to be seen as literal. For example,
[\.]{.regex} is a literal period and [\\]{.regex} is a literal
backslash. Escaping can be avoided by using \Q...\E. For example:
[\QLiteral Text\E]{.regex}.</p>
<p>Within a regular expression, special characters such as tab and newline
can be escaped with either an accent (`) or a backslash (\). For
example, [`t]{.regex} is the same as [\t]{.regex} except when the <a href="../misc/RegEx-QuickRef.htm#opt_x">x
option</a> is used.</p>
<p>To learn the basics of regular expressions (or refresh your memory of
pattern syntax), see the <a href="../misc/RegEx-QuickRef.htm">RegEx Quick
Reference</a>.</p>
<p>AutoHotkey\'s regular expressions are implemented using Perl-compatible
Regular Expressions (PCRE) from <a href="http://www.pcre.org/">www.pcre.org</a>.</p>
<p>Within an <a href="../Variables.htm#Expressions">expression</a>, <code>a ~= b</code> can be
used as shorthand for <code>RegExMatch(a, b)</code>.</p>
<h2 id="Related">Related</h2>
<p><a href="RegExReplace.htm">RegExReplace</a>, <a href="../misc/RegEx-QuickRef.htm">RegEx Quick
Reference</a>, <a href="../misc/RegExCallout.htm">Regular Expression
Callouts</a>, <a href="InStr.htm">InStr</a>,
<a href="SubStr.htm">SubStr</a>, <a href="SetTitleMatchMode.htm#RegEx">SetTitleMatchMode
RegEx</a>, <a href="https://www.autohotkey.com/board/topic/14817-">Global matching and Grep (archived
forum link)</a></p>
<p>Common sources of text data: <a href="FileRead.htm">FileRead</a>,
<a href="Download.htm">Download</a>, <a href="A_Clipboard.htm">A_Clipboard</a>, <a href="GuiControls.htm#Edit">GUI Edit
controls</a></p>
<h2 id="Examples">Examples</h2>
<p>For general RegEx examples, see the <a href="../misc/RegEx-QuickRef.htm">RegEx Quick
Reference</a>.</p>
<p>::: {#ExBasic .ex}
<a class="ex_number" href="#ExBasic"></a> Reports 4, which is the position where the
match was found.</p>
<pre class="codehilite"><code>MsgBox RegExMatch(&quot;xxxabc123xyz&quot;, &quot;abc.*xyz&quot;)
</code></pre>

<p>:::</p>
<p>::: {#ExDollar .ex}
<a class="ex_number" href="#ExDollar"></a> Reports 7 because the \$ requires the match to
be at the end.</p>
<pre class="codehilite"><code>MsgBox RegExMatch(&quot;abc123123&quot;, &quot;123$&quot;)
</code></pre>

<p>:::</p>
<p>::: {#ExCaseInsens .ex}
<a class="ex_number" href="#ExCaseInsens"></a> Reports 1 because a match was achieved via
the case-insensitive option.</p>
<pre class="codehilite"><code>MsgBox RegExMatch(&quot;abc123&quot;, &quot;i)^ABC&quot;)
</code></pre>

<p>:::</p>
<p>::: {#ExOutputVar .ex}
<a class="ex_number" href="#ExOutputVar"></a> Reports 1 and stores \"XYZ\" in
SubPat[1].</p>
<pre class="codehilite"><code>MsgBox RegExMatch(&quot;abcXYZ123&quot;, &quot;abc(.*)123&quot;, &amp;SubPat)
</code></pre>

<p>:::</p>
<p>::: {#ExStartingPos .ex}
<a class="ex_number" href="#ExStartingPos"></a> Reports 7 instead of 1 due to the
starting position 2 instead of 1.</p>
<pre class="codehilite"><code>MsgBox RegExMatch(&quot;abc123abc456&quot;, &quot;abc\d+&quot;,, 2)
</code></pre>

<p>:::</p>
<p>::: {#ExObject .ex}
<a class="ex_number" href="#ExObject"></a> Demonstrates the usage of the Match object.</p>
<pre class="codehilite"><code>FoundPos := RegExMatch(&quot;Michiganroad 72&quot;, &quot;(.*) (?&lt;nr&gt;\d+)&quot;, &amp;SubPat)
MsgBox SubPat.Count &quot;: &quot; SubPat[1] &quot; &quot; SubPat.Name[2] &quot;=&quot; SubPat.nr  ; Displays &quot;2: Michiganroad nr=72&quot;
</code></pre>

<p>:::</p>
<p>::: {#ExExtension .ex}
<a class="ex_number" href="#ExExtension"></a> Retrieves the extension of a file. Note
that <a href="SplitPath.htm">SplitPath</a> can also be used for this, which is more
reliable.</p>
<pre class="codehilite"><code>Path := &quot;C:\Foo\Bar\Baz.txt&quot;
RegExMatch(Path, &quot;\w+$&quot;, &amp;Extension)
MsgBox Extension[]  ; Reports &quot;txt&quot;.
</code></pre>

<p>:::</p>
<p>::: {#ExDeref .ex}
<a class="ex_number" href="#ExDeref"></a> Similar to AutoHotkey v1\'s Transform Deref,
the following function expands variable references and <a href="../misc/EscapeChar.htm">escape
sequences</a> contained inside other variables.
Furthermore, this example shows how to find all matches in a string
rather than stopping at the first match (similar to the g flag in
JavaScript\'s RegEx).</p>
<pre class="codehilite"><code>var1 := &quot;abc&quot;
var2 := 123
MsgBox Deref(&quot;%var1%def%var2%&quot;)  ; Reports abcdef123.

Deref(Str)
{
    spo := 1
    out := &quot;&quot;
    while (fpo:=RegexMatch(Str, &quot;(%(.*?)%)|``(.)&quot;, &amp;m, spo))
    {
        out .= SubStr(Str, spo, fpo-spo)
        spo := fpo + StrLen(m[0])
        if (m[1])
            out .= %m[2]%
        else switch (m[3])
        {
            case &quot;a&quot;: out .= &quot;`a&quot;
            case &quot;b&quot;: out .= &quot;`b&quot;
            case &quot;f&quot;: out .= &quot;`f&quot;
            case &quot;n&quot;: out .= &quot;`n&quot;
            case &quot;r&quot;: out .= &quot;`r&quot;
            case &quot;t&quot;: out .= &quot;`t&quot;
            case &quot;v&quot;: out .= &quot;`v&quot;
            default: out .= m[3]
        }
    }
    return out SubStr(Str, spo)
}
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/RegExMatch.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#regexmatch">RegExMatch</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Return_Value">Return Value</a></li>
<li><a href="#Errors">Errors</a></li>
<li><a href="#Options">Options</a></li>
<li><a href="#MatchObject">Match Object (RegExMatchInfo)</a></li>
<li><a href="#Performance">Performance</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/theme.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/syntax.js"></script>
</body>
</html>