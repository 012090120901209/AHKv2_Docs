<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ControlSend / ControlSendText | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Sends simulated keystrokes or text to a window or control.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/guides/Tutorial.html">Tutorial</a></li>
                            <li><a href="/guides/FAQ.html">FAQ</a></li>
                            <li><a href="/guides/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/functions/string/">String Functions</a></li>
                            <li><a href="/functions/window/">Window Functions</a></li>
                            <li><a href="/functions/file/">File Operations</a></li>
                            <li><a href="/functions/system/">System Functions</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/objects/Array.html">Array</a></li>
                            <li><a href="/objects/Map.html">Map</a></li>
                            <li><a href="/objects/Object.html">Object</a></li>
                            <li><a href="/objects/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/directives/_Include.html">#Include</a></li>
                            <li><a href="/directives/_Requires.html">#Requires</a></li>
                            <li><a href="/directives/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/reference/KeyList.html">Key List</a></li>
                            <li><a href="/reference/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/reference/Variables.html">Variables</a></li>
                            <li><a href="/reference/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>ControlSend</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="controlsend-controlsendtext">ControlSend / ControlSendText</h1>
<p>Sends simulated keystrokes or text to a window or control.</p>
<pre class="codehilite"><code class="language-Syntax">ControlSend Keys , Control, WinTitle, WinText, ExcludeTitle, ExcludeText
ControlSendText Keys , Control, WinTitle, WinText, ExcludeTitle, ExcludeText
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>Keys</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The sequence of keys to send (see the <a href="Send.htm">Send</a> function for
details). The rate at which characters are sent is determined by
<a href="SetKeyDelay.htm">SetKeyDelay</a>.</p>
<p>Unlike the <a href="Send.htm">Send</a> function, mouse clicks cannot be sent by
ControlSend. Use <a href="ControlClick.htm">ControlClick</a> for that.</p>
</dd>
<dt>Control</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a>,
<a href="../Concepts.htm#numbers">Integer</a> or
<a href="../Concepts.htm#objects">Object</a></p>
<p>If omitted, the keystrokes will be sent directly to the target
window instead of one of its controls (see <a href="../misc/Winamp.htm">Automating
Winamp</a> for an example). Otherwise, specify the
control\'s ClassNN, text or HWND, or an object with a <code>Hwnd</code>
property. For details, see <a href="Control.htm#Parameter">The Control
Parameter</a>.</p>
</dd>
<dt>WinTitle, WinText, ExcludeTitle, ExcludeText</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a>,
<a href="../Concepts.htm#numbers">Integer</a> or
<a href="../Concepts.htm#objects">Object</a></p>
<p>If each of these is blank or omitted, the <a href="../misc/WinTitle.htm#LastFoundWindow">Last Found
Window</a> will be used.
Otherwise, specify for <em>WinTitle</em> a <a href="../misc/WinTitle.htm">window title or other
criteria</a> to identify the target window and/or
for <em>WinText</em> a substring from a single text element of the target
window (as revealed by the included Window Spy utility).</p>
<p><em>ExcludeTitle</em> and <em>ExcludeText</em> can be used to exclude one or more
windows by their title or text. Their specification is similar to
<em>WinTitle</em> and <em>WinText</em>, except that <em>ExcludeTitle</em> does not
recognize any criteria other than the window title.</p>
<p>Window titles and text are case-sensitive. By default, hidden
windows are not detected and hidden text elements are detected,
unless changed with <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a>
and <a href="DetectHiddenText.htm">DetectHiddenText</a>; however, when using
<a href="../misc/WinTitle.htm#ahk_id">pure HWNDs</a>, hidden windows are always
detected regardless of DetectHiddenWindows. By default, a window
title can contain <em>WinTitle</em> or <em>ExcludeTitle</em> anywhere inside it to
be a match, unless changed with
<a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>.</p>
</dd>
</dl>
<h2 id="Error_Handling">Error Handling</h2>
<p>A <a href="Error.htm#TargetError">TargetError</a> is thrown if the window or
control could not be found.</p>
<h2 id="Remarks">Remarks</h2>
<p>ControlSendText sends the individual characters of the <em>Keys</em> parameter
without translating <code>{Enter}</code> to [Enter]{.kbd}, <code>^c</code> to
[Ctrl]{.kbd}+[C]{.kbd}, etc. For details, see <a href="Send.htm#SendText">Text
mode</a>. It is also valid to use <a href="Send.htm#Raw">{Raw}</a>
or <a href="Send.htm#Text">{Text}</a> with ControlSend.</p>
<p>If the <em>Control</em> parameter is omitted, this function will attempt to
send directly to the target window by sending to its topmost control
(which is often the correct one) or the window itself if there are no
controls. This is useful if a window does not appear to have any
controls at all, or just for the convenience of not having to worry
about which control to send to.</p>
<p>By default, modifier keystrokes (Ctrl, Alt, Shift, and Win) are sent as
they normally would be by the Send function. This allows command prompt
and other console windows to properly detect uppercase letters, control
characters, etc. It may also improve reliability in other ways.</p>
<p>However, in some cases these modifier events may interfere with the
active window, especially if the user is actively typing during a
ControlSend or if [Alt]{.kbd} is being sent (since [Alt]{.kbd} activates
the active window\'s menu bar). This can be avoided by explicitly
sending modifier up and down events as in this example:</p>
<pre class="codehilite"><code>ControlSend &quot;{Alt down}f{Alt up}&quot;, &quot;Edit1&quot;, &quot;Untitled - Notepad&quot;
</code></pre>

<p>The method above also allows the sending of modifier keystrokes (Ctrl,
Alt, Shift, and Win) while the workstation is locked (protected by logon
prompt).</p>
<p><a href="BlockInput.htm">BlockInput</a> should be avoided when using ControlSend
against a console window such as command prompt. This is because it
might prevent capitalization and modifier keys such as [Ctrl]{.kbd} from
working properly.</p>
<p>The value of <a href="SetKeyDelay.htm">SetKeyDelay</a> determines the speed at
which keys are sent. If the target window does not receive the
keystrokes reliably, try increasing the press duration via the second
parameter of <a href="SetKeyDelay.htm">SetKeyDelay</a> as in these examples:</p>
<pre class="codehilite"><code>SetKeyDelay 10, 10
SetKeyDelay 0, 10
SetKeyDelay -1, 0
</code></pre>

<p>If the target control is an Edit control (or something similar), the
following are usually more reliable and faster than ControlSend:</p>
<pre class="codehilite"><code>EditPaste(&quot;This text will be inserted at the caret position.&quot;, ControlName, WinTitle)

ControlSetText(&quot;This text will entirely replace any current text.&quot;, ControlName, WinTitle)
</code></pre>

<p>ControlSend is generally not capable of manipulating a window\'s menu
bar. To work around this, use <a href="MenuSelect.htm">MenuSelect</a>. If that is
not possible due to the nature of the menu bar, you could try to
discover the message that corresponds to the desired menu item by
following the <a href="../misc/SendMessage.htm">SendMessage Tutorial</a>.</p>
<h2 id="Related">Related</h2>
<p><a href="SetKeyDelay.htm">SetKeyDelay</a>, <a href="../misc/EscapeChar.htm">Escape sequences (e.g.
`n)</a> , <a href="Control.htm">Control functions</a>,
<a href="Send.htm">Send</a>, <a href="../misc/Winamp.htm">Automating Winamp</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExNotepad .ex}
<a class="ex_number" href="#ExNotepad"></a> Opens Notepad minimized and send it some
text. This example may fail on Windows 11 or later, as it requires the
classic version of Notepad.</p>
<pre class="codehilite"><code>Run &quot;Notepad&quot;,, &quot;Min&quot;, &amp;PID  ; Run Notepad minimized.
WinWait &quot;ahk_pid &quot; PID  ; Wait for it to appear.
; Send the text to the inactive Notepad edit control.
; The third parameter is omitted so the last found window is used.
ControlSend &quot;This is a line of text in the notepad window.{Enter}&quot;, &quot;Edit1&quot;
ControlSendText &quot;Notice that {Enter} is not sent as an Enter keystroke with ControlSendText.&quot;, &quot;Edit1&quot;

Msgbox &quot;Press OK to activate the window to see the result.&quot;
WinActivate &quot;ahk_pid &quot; PID  ; Show the result.
</code></pre>

<p>:::</p>
<p>::: {#ExCmd .ex}
<a class="ex_number" href="#ExCmd"></a> Opens the command prompt and sent it some text.
This example may fail on Windows 11 or later, as it requires the classic
version of the command prompt.</p>
<pre class="codehilite"><code>SetTitleMatchMode 2
Run A_ComSpec,,, &amp;PID  ; Run command prompt.
WinWait &quot;ahk_pid &quot; PID  ; Wait for it to appear.
ControlSend &quot;ipconfig{Enter}&quot;,, &quot;cmd.exe&quot;  ; Send directly to the command prompt window.
</code></pre>

<p>:::</p>
<p>::: {#ExGUI .ex}
<a class="ex_number" href="#ExGUI"></a> Creates a <a href="Gui.htm">GUI</a> with an edit control and
sent it some text.</p>
<pre class="codehilite"><code>MyGui := Gui()
MyGui.Add(&quot;Edit&quot;, &quot;r10 w500&quot;)
MyGui.Show()
ControlSend &quot;This is a line of text in the edit control.{Enter}&quot;, &quot;Edit1&quot;, MyGui
ControlSendText &quot;Notice that {Enter} is not sent as an Enter keystroke with ControlSendText.&quot;, &quot;Edit1&quot;, MyGui
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/ControlSend.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#controlsend-controlsendtext">ControlSend / ControlSendText</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Error_Handling">Error Handling</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/theme.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/syntax.js"></script>
</body>
</html>