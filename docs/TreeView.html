<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TreeView | AutoHotkey v2 Documentation</title>
    <meta name="description" content="## Table of Contents {#toc}">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/AHKv2_Docs/css/styles.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/sidebar.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/markdown.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/AHKv2_Docs/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Tutorial.html">Tutorial</a></li>
                            <li><a href="/AHKv2_Docs/FAQ.html">FAQ</a></li>
                            <li><a href="/AHKv2_Docs/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Functions.html">Functions</a></li>
                            <li><a href="/AHKv2_Docs/StrLen.html">String Functions</a></li>
                            <li><a href="/AHKv2_Docs/WinActivate.html">Window Functions</a></li>
                            <li><a href="/AHKv2_Docs/FileRead.html">File Operations</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Array.html">Array</a></li>
                            <li><a href="/AHKv2_Docs/Map.html">Map</a></li>
                            <li><a href="/AHKv2_Docs/Object.html">Object</a></li>
                            <li><a href="/AHKv2_Docs/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/_Include.html">#Include</a></li>
                            <li><a href="/AHKv2_Docs/_Requires.html">#Requires</a></li>
                            <li><a href="/AHKv2_Docs/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/KeyList.html">Key List</a></li>
                            <li><a href="/AHKv2_Docs/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/AHKv2_Docs/Variables.html">Variables</a></li>
                            <li><a href="/AHKv2_Docs/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/AHKv2_Docs/">Home</a> <i class="fas fa-chevron-right"></i> <span>TreeView</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="treeview">TreeView</h1>
<h2 id="toc">Table of Contents</h2>
<ul>
<li><a href="#Intro">Introduction and Simple Example</a></li>
<li><a href="#Options">Options and Styles for the Options Parameter</a></li>
<li><a href="#BuiltIn">Built-in Methods for TreeViews</a></li>
<li><a href="#Events">Events</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
<h2 id="Intro">Introduction and Simple Example</h2>
<p>A TreeView displays a hierarchy of items by indenting child items
beneath their parents. The most common example is Explorer\'s tree of
drives and folders.</p>
<p>A TreeView usually looks like this:</p>
<p><img alt="TreeView" src="../static/ctrl_treeview.png" /></p>
<p>The syntax for creating a TreeView is:</p>
<pre class="codehilite"><code class="language-Syntax">TV := GuiObj.Add(&quot;TreeView&quot;, Options)
</code></pre>

<p>Or:</p>
<pre class="codehilite"><code class="language-Syntax">TV := GuiObj.AddTreeView(Options)
</code></pre>

<p>Here is a working script that creates and displays a simple hierarchy of
items:</p>
<pre class="codehilite"><code>MyGui := Gui()
TV := MyGui.Add(&quot;TreeView&quot;)
P1 := TV.Add(&quot;First parent&quot;)
P1C1 := TV.Add(&quot;Parent 1's first child&quot;, P1)  ; Specify P1 to be this item's parent.
P2 := TV.Add(&quot;Second parent&quot;)
P2C1 := TV.Add(&quot;Parent 2's first child&quot;, P2)
P2C2 := TV.Add(&quot;Parent 2's second child&quot;, P2)
P2C2C1 := TV.Add(&quot;Child 2's first child&quot;, P2C2)

MyGui.Show()  ; Show the window and its TreeView.
</code></pre>

<h2 id="Options">Options and Styles for the Options Parameter</h2>
<p><strong>Background:</strong> Specify the word <em>Background</em> followed immediately by a
color name (see <a href="../misc/Colors.htm">color chart</a>) or RGB value (the 0x
prefix is optional). Examples: <code>BackgroundSilver</code>, <code>BackgroundFFDD99</code>.
If this option is not present, the TreeView initially defaults to the
system\'s default background color. Specifying <code>BackgroundDefault</code> or
<code>-Background</code> applies the system\'s default background color (usually
white). For example, a TreeView can be restored to the default color via
<code>TV.Opt("+BackgroundDefault")</code>.</p>
<p><strong>Buttons:</strong> Specify <code>-Buttons</code> (minus Buttons) to avoid displaying a
plus or minus button to the left of each item that has children.</p>
<p><strong>C:</strong> Text color. Specify the letter C followed immediately by a color
name (see <a href="../misc/Colors.htm">color chart</a>) or RGB value (the 0x prefix
is optional). Examples: <code>cRed</code>, <code>cFF2211</code>, <code>c0xFF2211</code>, <code>cDefault</code>.</p>
<p><strong>Checked:</strong> Provides a checkbox at the left side of each item. When
<a href="#Add">adding</a> an item, specify the word <em>Check</em> in its options to have
the box to start off checked instead of unchecked. The user may either
click the checkbox or press the spacebar to check or uncheck an item. To
discover which items in a TreeView are currently checked, call the
<a href="#GetNext">GetNext method</a> or <a href="#Get">Get method</a>.</p>
<p><strong>HScroll:</strong> Specify <code>-HScroll</code> (minus HScroll) to disable horizontal
scrolling in the control (in addition, the control will not display any
horizontal scroll bar).</p>
<p><strong>ImageList:</strong> This is the means by which icons are added to a TreeView.
Specify the word <em>ImageList</em> followed immediately by the ImageListID
returned from a previous call to <a href="ListView.htm#IL_Create">IL_Create</a>.
This option has an effect only when creating a TreeView (however, the
<a href="#SetImageList">SetImageList method</a> does not have this limitation).
Here is a working example:</p>
<pre class="codehilite"><code>MyGui := Gui()
ImageListID := IL_Create(10)  ; Create an ImageList with initial capacity for 10 icons.
Loop 10  ; Load the ImageList with some standard system icons.
    IL_Add(ImageListID, &quot;shell32.dll&quot;, A_Index)
TV := MyGui.Add(&quot;TreeView&quot;, &quot;ImageList&quot; . ImageListID)
TV.Add(&quot;Name of Item&quot;, 0, &quot;Icon4&quot;)  ; Add an item to the TreeView and give it a folder icon.
MyGui.Show()
</code></pre>

<p><strong>Lines:</strong> Specify <code>-Lines</code> (minus Lines) to avoid displaying a network
of lines connecting parent items to their children. However, removing
these lines also prevents the plus/minus buttons from being shown for
top-level items.</p>
<p><strong>ReadOnly:</strong> Specify <code>-ReadOnly</code> (minus ReadOnly) to allow editing of
the text/name of each item. To edit an item, select it then press
[F2]{.kbd} (see the <a href="#WantF2">WantF2</a> option below). Alternatively, you
can click an item once to select it, wait at least half a second, then
click the same item again to edit it. After being edited, an item can be
alphabetically repositioned among its siblings via the following
example:</p>
<pre class="codehilite"><code>TV := MyGui.Add(&quot;TreeView&quot;, &quot;-ReadOnly&quot;)
TV.OnEvent(&quot;ItemEdit&quot;, TV_Edit)  ; Call TV_Edit whenever a user has finished editing an item.
; ...
TV_Edit(TV, Item)
{
    TV.Modify(TV.GetParent(Item), &quot;Sort&quot;)  ; This works even if the item has no parent.
}
</code></pre>

<p><strong>R:</strong> Rows of height (upon creation). Specify the letter R followed
immediately by the number of rows for which to make room inside the
control. For example, <code>R10</code> would make the control 10 items tall.</p>
<p><strong>WantF2:</strong> Specify <code>-WantF2</code> (minus WantF2) to prevent [F2]{.kbd} from
<a href="#ReadOnly">editing</a> the currently selected item. This setting is
ignored unless <a href="#ReadOnly">-ReadOnly</a> is also in effect.</p>
<p><strong>(Unnamed numeric styles):</strong> Since styles other than the above are
rarely used, they do not have names. See the <a href="../misc/Styles.htm#TreeView">TreeView styles
table</a> for a list.</p>
<h2 id="BuiltIn">Built-in Methods for TreeViews</h2>
<p>In addition to the <a href="GuiControl.htm">default methods/properties of a GUI
control</a>, TreeView controls have the following methods
(defined in the Gui.TreeView class).</p>
<p>Item methods:</p>
<ul>
<li><a href="#Add">Add</a>: Adds a new item to the TreeView.</li>
<li><a href="#Modify">Modify</a>: Modifies the attributes and/or name of an item.</li>
<li><a href="#Delete">Delete</a>: Deletes the specified item or all items.</li>
</ul>
<p>Retrieval methods:</p>
<ul>
<li><a href="#GetSelection">GetSelection</a>: Returns the selected item\'s ID
    number.</li>
<li><a href="#GetCount">GetCount</a>: Returns the total number of items in the
    control.</li>
<li><a href="#GetParent">GetParent</a>: Returns the ID number of the specified
    item\'s parent.</li>
<li><a href="#GetChild">GetChild</a>: Returns the ID number of the specified
    item\'s first/top child.</li>
<li><a href="#GetPrev">GetPrev</a>: Returns the ID number of the sibling above the
    specified item.</li>
<li><a href="#GetNext">GetNext</a>: Returns the ID number of the next item below
    the specified item.</li>
<li><a href="#GetText">GetText</a>: Retrieves the text/name of the specified item.</li>
<li><a href="#Get">Get</a>: Returns the ID number of the specified item if it has
    the specified attribute.</li>
</ul>
<p>Other methods:</p>
<ul>
<li><a href="#SetImageList">SetImageList</a>: Sets or replaces an ImageList for
    displaying icons.</li>
</ul>
<p>::: {#Add .methodShort}</p>
<h3 id="add">Add</h3>
<p>Adds a new item to the TreeView.</p>
<pre class="codehilite"><code class="language-Syntax">ItemID := TV.Add(Name, ParentItemID, Options)
</code></pre>

<h4 id="Add_Parameters">Parameters</h4>
<dl>
<dt>Name</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The displayed text of the item, which can be text or numeric
(including numeric <a href="../Variables.htm#Expressions">expression</a>
results).</p>
</dd>
<dt>ParentItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 0, meaning the item will be added at the
top level. Otherwise, specify the ID number of the new item\'s
parent.</p>
</dd>
<dt>Options</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If blank or omitted, it defaults to no options. Otherwise, specify
one or more options from the list below (not case-sensitive).
Separate each option from the next with a space or tab. To remove an
option, precede it with a minus sign. To add an option, a plus sign
is permitted but not required.</p>
<p><strong>Bold:</strong> Displays the item\'s name in a bold font. To later un-bold
the item, use <code>TV.Modify(ItemID, "-Bold")</code>. The word <em>Bold</em> may
optionally be followed immediately by a 0 or 1 to indicate the
starting state.</p>
<p><strong>Check:</strong> Shows a checkmark to the left of the item (if the
TreeView has <a href="#Checked">checkboxes</a>). To later uncheck it, use
<code>TV.Modify(ItemID, "-Check")</code>. The word <em>Check</em> may optionally be
followed immediately by a 0 or 1 to indicate the starting state. In
other words, both <code>"Check"</code> and <code>"Check"</code><strong><code>.</code></strong><code>VarContainingOne</code>
are the same (the period used here is the <a href="../Variables.htm#concat">concatenation
operator</a>).</p>
<p><strong>Expand:</strong> Expands the item to reveal its children (if any). To
later collapse the item, use <code>TV.Modify(ItemID, "-Expand")</code>. If
there are no children, the <a href="#Modify">Modify method</a> returns 0
instead of the item\'s ID. By contrast, the <a href="#Add">Add method</a> marks
the item as expanded in case children are added to it later. Unlike
the <a href="#Select">Select</a> option below, expanding an item does not
automatically expand its parent. Finally, the word <em>Expand</em> may
optionally be followed immediately by a 0 or 1 to indicate the
starting state. In other words, both <code>"Expand"</code> and
<code>"Expand"</code><strong><code>.</code></strong><code>VarContainingOne</code> are the same.</p>
<p><strong>First | Sort | N:</strong> These options apply only to the <a href="#Add">Add
method</a>. They specify the new item\'s position relative to its
siblings (a <em>sibling</em> is any other item on the same level). If none
of these options is present, the new item is added as the
last/bottom sibling. Otherwise, specify the word <em>First</em> to add the
item as the first/top sibling, or specify the word <em>Sort</em> to insert
it among its siblings in alphabetical order. If a plain integer <em>N</em>
is specified, it is assumed to be ID number of the sibling after
which to insert the new item (if <em>N</em> is the only option present, it
does not have to be enclosed in quotes).</p>
<p><strong>Icon:</strong> Specify the word <em>Icon</em> followed immediately by the number
of this item\'s icon, which is displayed to the left of the item\'s
name. If this option is absent, the first icon in the
<a href="#ImageList">ImageList</a> is used. To display a blank icon, specify a
number that is larger than the number of icons in the ImageList. If
the control lacks an ImageList, no icon is displayed nor is any
space reserved for one.</p>
<p><strong>Select:</strong> Selects the item. Since only one item at a time can be
selected, any previously selected item is automatically de-selected.
In addition, this option reveals the newly selected item by
expanding its parent(s), if necessary. To find out the current
selection, call the <a href="#GetSelection">GetSelection method</a>.</p>
<p><strong>Sort:</strong> For the <a href="#Modify">Modify method</a>, this option
alphabetically sorts the children of the specified item. To instead
sort all top-level items, use <code>TV.Modify(0, "Sort")</code>. If there are
no children, 0 is returned instead of the ID of the modified item.</p>
<p><strong>Vis:</strong> Ensures that the item is completely visible by scrolling
the TreeView and/or expanding its parent, if necessary.</p>
<p><strong>VisFirst:</strong> Same as above except that the TreeView is also
scrolled so that the item appears at the top, if possible. This
option is typically more effective when used with the <a href="#Modify">Modify
method</a> than with the <a href="#Add">Add method</a>.</p>
</dd>
</dl>
<h4 id="Add_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>On success, this method returns the unique ID number of the newly added
item. On failure, it returns 0.</p>
<h4 id="Add_Remarks">Remarks</h4>
<p>When adding a large number of items, performance can be improved by
using <code>TV.Opt("-Redraw")</code> before adding the items and
<code>TV.Opt("+Redraw")</code> afterward. See
<a href="GuiControl.htm#redraw-remarks">Redraw</a> for more details.
:::</p>
<p>::: {#Modify .methodShort}</p>
<h3 id="modify">Modify</h3>
<p>Modifies the attributes and/or name of an item.</p>
<pre class="codehilite"><code class="language-Syntax">ItemID := TV.Modify(ItemID , Options, NewName)
</code></pre>

<h4 id="Modify_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item to modify.</p>
</dd>
<dt>Options</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If this and the <em>NewName</em> parameter is omitted, the item will be
selected. Otherwise, specify one or more options from the <a href="#Options_for_Add_and_Modify">list
above</a>.</p>
</dd>
<dt>NewName</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If omitted, the current name is left unchanged. Otherwise, specify
the new name of the item.</p>
</dd>
</dl>
<h4 id="Modify_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the item\'s own ID.
:::</p>
<p>::: {#Delete .methodShort}</p>
<h3 id="delete">Delete</h3>
<p>Deletes the specified item or all items.</p>
<pre class="codehilite"><code class="language-Syntax">TV.Delete(ItemID)
</code></pre>

<h4 id="Delete_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, [all]{.underline} items in the TreeView are deleted.
Otherwise, specify the ID number of the item to delete.
:::</p>
</dd>
</dl>
<p>::: {#GetSelection .methodShort}</p>
<h3 id="getselection">GetSelection</h3>
<p>Returns the selected item\'s ID number.</p>
<pre class="codehilite"><code class="language-Syntax">ItemID := TV.GetSelection()
</code></pre>

<h4 id="GetSelection_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the selected item\'s ID number.
:::</p>
<p>::: {#GetCount .methodShort}</p>
<h3 id="getcount">GetCount</h3>
<p>Returns the total number of items in the control.</p>
<pre class="codehilite"><code class="language-Syntax">Count := TV.GetCount()
</code></pre>

<h4 id="GetCount_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the total number of items in the control. The value
is always returned immediately because the control keeps track of the
count.
:::</p>
<p>::: {#GetParent .methodShort}</p>
<h3 id="getparent">GetParent</h3>
<p>Returns the ID number of the specified item\'s parent.</p>
<pre class="codehilite"><code class="language-Syntax">ParentItemID := TV.GetParent(ItemID)
</code></pre>

<h4 id="GetParent_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item to check.</p>
</dd>
</dl>
<h4 id="GetParent_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the ID number of the specified item\'s parent. If
the item has no parent, it returns 0, which applies to all top-level
items.
:::</p>
<p>::: {#GetChild .methodShort}</p>
<h3 id="getchild">GetChild</h3>
<p>Returns the ID number of the specified item\'s first/top child.</p>
<pre class="codehilite"><code class="language-Syntax">ChildItemID := TV.GetChild(ItemID)
</code></pre>

<h4 id="GetChild_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item to check. If 0, the ID number of the
first/top item in the TreeView is returned.</p>
</dd>
</dl>
<h4 id="GetChild_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the ID number of the specified item\'s first/top
child. If there is no child, it returns 0.
:::</p>
<p>::: {#GetPrev .methodShort}</p>
<h3 id="getprev">GetPrev</h3>
<p>Returns the ID number of the sibling above the specified item.</p>
<pre class="codehilite"><code class="language-Syntax">PrevItemID := TV.GetPrev(ItemID)
</code></pre>

<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item to check.</p>
</dd>
</dl>
<h4 id="GetPrev_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the ID number of the sibling above the specified
item. If there is no sibling, it returns 0.
:::</p>
<p>::: {#GetNext .methodShort}</p>
<h3 id="getnext">GetNext</h3>
<p>Returns the ID number of the next item below the specified item.</p>
<pre class="codehilite"><code class="language-Syntax">NextItemID := TV.GetNext(ItemID, ItemType)
</code></pre>

<h4 id="GetNext_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 0, meaning the ID number of the first/top
item in the TreeView is returned. Otherwise, specify the ID number
of the item to check.</p>
</dd>
<dt>ItemType</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If omitted, the ID number of the sibling below the specified item
will be retrieved. Otherwise, specify one of the following strings:</p>
<p><strong>Full</strong> or <strong>F</strong>: Retrieves the next item regardless of its
relationship to the specified item. This allows the script to easily
traverse the entire tree, item by item. See the example below.</p>
<p><strong>Check</strong>, <strong>Checked</strong> or <strong>C</strong>: Gets only the next item with a
checkmark.</p>
</dd>
</dl>
<h4 id="GetNext_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This method returns the ID number of the next item below the specified
item. If there is no next item, it returns 0.</p>
<h4 id="GetNext_Remarks">Remarks</h4>
<p>The following example traverses the entire tree, item by item:</p>
<pre class="codehilite"><code>ItemID := 0  ; Causes the loop's first iteration to start the search at the top of the tree.
Loop
{
    ItemID := TV.GetNext(ItemID, &quot;Full&quot;)  ; Replace &quot;Full&quot; with &quot;Checked&quot; to find all checkmarked items.
    if not ItemID  ; No more items in tree.
        break
    ItemText := TV.GetText(ItemID)
    MsgBox('The next Item is ' ItemID ', whose text is &quot;' ItemText '&quot;.')
}
</code></pre>

<p>:::</p>
<p>::: {#GetText .methodShort}</p>
<h3 id="gettext">GetText</h3>
<p>Retrieves the text/name of the specified item.</p>
<pre class="codehilite"><code class="language-Syntax">Text := TV.GetText(ItemID)
</code></pre>

<h4 id="GetText_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item whose text to be retrieved.</p>
</dd>
</dl>
<h4 id="GetText_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>This method returns the retrieved text. Only up to 8191 characters are
retrieved.
:::</p>
<p>::: {#Get .methodShort}</p>
<h3 id="get">Get</h3>
<p>Returns the ID number of the specified item if it has the specified
attribute.</p>
<pre class="codehilite"><code class="language-Syntax">ItemID := TV.Get(ItemID, Attribute)
</code></pre>

<h4 id="Get_Parameters">Parameters</h4>
<dl>
<dt>ItemID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number of the item to check.</p>
</dd>
<dt>Attribute</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>Specify one of the following strings:</p>
<p><strong>E</strong>, <strong>Expand</strong> or <strong>Expanded</strong>: The item is currently
<a href="#Expand">expanded</a> (i.e. its children are being displayed).</p>
<p><strong>C</strong>, <strong>Check</strong> or <strong>Checked</strong>: The item has a <a href="#Check">checkmark</a>.</p>
<p><strong>B</strong> or <strong>Bold</strong>: The item is currently <a href="#Bold">bold</a> in font.</p>
</dd>
</dl>
<h4 id="Get_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If the specified item has the specified attribute, its own ID is
returned. Otherwise, 0 is returned.</p>
<h4 id="Get_Remarks">Remarks</h4>
<p>Since an IF-statement sees any non-zero value as \"true\", the following
two lines are functionally identical:
<code>if TV.Get(ItemID, "Checked") = ItemID</code> and
<code>if TV.Get(ItemID, "Checked")</code>.
:::</p>
<p>::: {#SetImageList .methodShort}</p>
<h3 id="setimagelist">SetImageList</h3>
<p>Sets or replaces an <a href="ListView.htm#IL">ImageList</a> for displaying icons.</p>
<pre class="codehilite"><code class="language-Syntax">PrevImageListID := TV.SetImageList(ImageListID , IconType)
</code></pre>

<h4 id="SetImageList_Parameters">Parameters</h4>
<dl>
<dt>ImageListID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The ID number returned from a previous call to
<a href="ListView.htm#IL_Create">IL_Create</a>.</p>
</dd>
<dt>IconType</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 0. Otherwise, specify 2 for state icons
(which are not yet directly supported, but could be used via
<a href="SendMessage.htm">SendMessage</a>).</p>
</dd>
</dl>
<h4 id="SetImageList_Return_Value">Return Value</h4>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>On success, this method returns the ImageList ID that was previously
associated with the TreeView. On failure, it returns 0. Any such
detached ImageList should normally be destroyed via
<a href="ListView.htm#IL_Destroy">IL_Destroy</a>.
:::</p>
<h2 id="Events">Events</h2>
<p>The following events can be detected by calling
<a href="GuiOnEvent.htm">OnEvent</a> to register a callback function or method:</p>
<p>Event                                            Raised when...</p>
<hr />
<p><a href="GuiOnEvent.htm#Click">Click</a>                    The control is clicked.
  <a href="GuiOnEvent.htm#DoubleClick">DoubleClick</a>        The control is double-clicked.
  <a href="GuiOnEvent.htm#Ctrl-ContextMenu">ContextMenu</a>   The user right-clicks the control or presses [Menu]{.kbd} or [Shift]{.kbd}+[F10]{.kbd} while the control has the keyboard focus.
  <a href="GuiOnEvent.htm#Focus">Focus</a>                    The control gains the keyboard focus.
  <a href="GuiOnEvent.htm#LoseFocus">LoseFocus</a>            The control loses the keyboard focus.
  <a href="GuiOnEvent.htm#ItemCheck">ItemCheck</a>            An item is checked or unchecked.
  <a href="GuiOnEvent.htm#ItemEdit">ItemEdit</a>              An item\'s label is edited by the user.
  <a href="GuiOnEvent.htm#ItemExpand">ItemExpand</a>          An item is expanded or collapsed.
  <a href="GuiOnEvent.htm#ItemSelect">ItemSelect</a>          An item is selected.</p>
<p>Additional (rarely-used) notifications can be detected by using
<a href="GuiOnNotify.htm">OnNotify</a>. These notifications are <a href="https://learn.microsoft.com/windows/win32/controls/bumper-tree-view-control-reference-notifications">documented at
Microsoft
Docs</a>.
Microsoft Docs does not show the numeric value of each notification
code; those can be found in the Windows SDK or by searching the
Internet.</p>
<h2 id="Remarks">Remarks</h2>
<p>To detect when the user has pressed [Enter]{.kbd} while a TreeView has
focus, use a <a href="GuiControls.htm#DefaultButton">default button</a> (which can
be hidden if desired). For example:</p>
<pre class="codehilite"><code>MyGui.Add(&quot;Button&quot;, &quot;Hidden Default&quot;, &quot;OK&quot;).OnEvent(&quot;Click&quot;, ButtonOK)
...
ButtonOK(*) {
    global
    if MyGui.FocusedCtrl != TV
        return
    MsgBox(&quot;Enter was pressed. The selected item ID is &quot; TV.GetSelection())
}
</code></pre>

<p>In addition to navigating from item to item with the keyboard, the user
may also perform incremental search by typing the first few characters
of an item\'s name. This causes the selection to jump to the nearest
matching item.</p>
<p>Although any length of text can be stored in each item of a TreeView,
only the first 260 characters are displayed.</p>
<p>Although the theoretical maximum number of items in a TreeView is 65536,
item-adding performance will noticeably decrease long before then. This
can be alleviated somewhat by using the redraw tip described in the <a href="#Add">Add
method</a>.</p>
<p>Unlike <a href="ListView.htm">ListViews</a>, a TreeView\'s ImageList is not
automatically destroyed when the TreeView is destroyed. Therefore, a
script should call <a href="ListView.htm#IL_Destroy">IL_Destroy</a> after
destroying a TreeView\'s window if the ImageList will not be used for
anything else. However, this is not necessary if the script will soon be
exiting because all ImageLists are automatically destroyed at that time.</p>
<p>A script may create more than one TreeView per window.</p>
<p>To perform actions such as resizing, hiding, or changing the font of a
TreeView, see <a href="GuiControl.htm">GuiControl object</a>.</p>
<p>Tree View eXtension (TVX) extends TreeViews to support moving, inserting
and deleting. It is demonstrated at <a href="https://www.autohotkey.com/board/topic/17497-">this archived forum
thread</a>.</p>
<h2 id="Related">Related</h2>
<p><a href="ListView.htm">ListView</a>, <a href="GuiControls.htm">Other Control Types</a>,
<a href="Gui.htm#Call">Gui()</a>, <a href="GuiOnEvent.htm#ContextMenu">ContextMenu event</a>,
<a href="GuiControl.htm">Gui object</a>, <a href="GuiControl.htm">GuiControl object</a>,
<a href="../misc/Styles.htm#TreeView">TreeView styles table</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExAdvanced .ex}
<a class="ex_number" href="#ExAdvanced"></a> The following is a working script that is
more elaborate than the one near the top of this page. It creates and
displays a TreeView containing all folders in the all-users Start Menu.
When the user selects a folder, its contents are shown in a ListView to
the right (like Windows Explorer). In addition, a
<a href="GuiControls.htm#StatusBar">StatusBar</a> control shows information about
the currently selected folder.</p>
<pre class="codehilite"><code>; The following folder will be the root folder for the TreeView. Note that loading might take a long
; time if an entire drive such as C:\ is specified:
TreeRoot := A_MyDocuments
TreeViewWidth := 280
ListViewWidth := A_ScreenWidth/2 - TreeViewWidth - 30

; Create the Gui window and display the source directory (TreeRoot) in the title bar:
MyGui := Gui(&quot;+Resize&quot;, TreeRoot)  ; Allow the user to maximize or drag-resize the window.

; Create an ImageList and put some standard system icons into it:
ImageListID := IL_Create(5)
Loop 5 
    IL_Add(ImageListID, &quot;shell32.dll&quot;, A_Index)
; Create a TreeView and a ListView side-by-side to behave like Windows Explorer:
TV := MyGui.Add(&quot;TreeView&quot;, &quot;r20 w&quot; TreeViewWidth &quot; ImageList&quot; ImageListID)
LV := MyGui.Add(&quot;ListView&quot;, &quot;r20 w&quot; ListViewWidth &quot; x+10&quot;, [&quot;Name&quot;, &quot;Modified&quot;])

; Create a Status Bar to give info about the number of files and their total size:
SB := MyGui.Add(&quot;StatusBar&quot;)
SB.SetParts(60, 85)  ; Create three parts in the bar (the third part fills all the remaining width).

; Add folders and their subfolders to the tree. Display the status in case loading takes a long time:
M := Gui(&quot;ToolWindow -SysMenu Disabled AlwaysOnTop&quot;, &quot;Loading the tree...&quot;), M.Show(&quot;w200 h0&quot;)
DirList := AddSubFoldersToTree(TreeRoot, Map())
M.Hide()

; Call TV_ItemSelect whenever a new item is selected:
TV.OnEvent(&quot;ItemSelect&quot;, TV_ItemSelect)

; Call Gui_Size whenever the window is resized:
MyGui.OnEvent(&quot;Size&quot;, Gui_Size)

; Set the ListView's column widths (this is optional):
Col2Width := 70  ; Narrow to reveal only the YYYYMMDD part.
LV.ModifyCol(1, ListViewWidth - Col2Width - 30)  ; Allows room for vertical scrollbar.
LV.ModifyCol(2, Col2Width)

; Display the window. The OS will notify the script whenever the user performs an eligible action:
MyGui.Show()

AddSubFoldersToTree(Folder, DirList, ParentItemID := 0)
{
    ; This function adds to the TreeView all subfolders in the specified folder
    ; and saves their paths associated with an ID into an object for later use.
    ; It also calls itself recursively to gather nested folders to any depth.
    Loop Files, Folder &quot;\*.*&quot;, &quot;D&quot;  ; Retrieve all of Folder's sub-folders.
    {
        ItemID := TV.Add(A_LoopFileName, ParentItemID, &quot;Icon4&quot;)
        DirList[ItemID] := A_LoopFilePath
        DirList := AddSubFoldersToTree(A_LoopFilePath, DirList, ItemID)
    }
    return DirList
}

TV_ItemSelect(thisCtrl, Item)  ; This function is called when a new item is selected.
{
    ; Put the files into the ListView:
    LV.Delete()  ; Clear all rows.
    LV.Opt(&quot;-Redraw&quot;)  ; Improve performance by disabling redrawing during load.
    TotalSize := 0  ; Init prior to loop below.
    Loop Files, DirList[Item] &quot;\*.*&quot;  ; For simplicity, omit folders so that only files are shown in the ListView.
    {
        LV.Add(, A_LoopFileName, A_LoopFileTimeModified)
        TotalSize += A_LoopFileSize
    }
    LV.Opt(&quot;+Redraw&quot;)

    ; Update the three parts of the status bar to show info about the currently selected folder:
    SB.SetText(LV.GetCount() &quot; files&quot;, 1)
    SB.SetText(Round(TotalSize / 1024, 1) &quot; KB&quot;, 2)
    SB.SetText(DirList[Item], 3)
}

Gui_Size(thisGui, MinMax, Width, Height)  ; Expand/Shrink ListView and TreeView in response to the user's resizing.
{
    if MinMax = -1  ; The window has been minimized.  No action needed.
        return
    ; Otherwise, the window has been resized or maximized. Resize the controls to match.
    TV.GetPos(,, &amp;TV_W)
    TV.Move(,,, Height - 30)  ; -30 for StatusBar and margins.
    LV.Move(,, Width - TV_W - 30, Height - 30)
}
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/TreeView.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#treeview">TreeView</a><ul>
<li><a href="#toc">Table of Contents</a></li>
<li><a href="#Intro">Introduction and Simple Example</a></li>
<li><a href="#Options">Options and Styles for the Options Parameter</a></li>
<li><a href="#BuiltIn">Built-in Methods for TreeViews</a><ul>
<li><a href="#add">Add</a><ul>
<li><a href="#Add_Parameters">Parameters</a></li>
<li><a href="#Add_Return_Value">Return Value</a></li>
<li><a href="#Add_Remarks">Remarks</a></li>
</ul>
</li>
<li><a href="#modify">Modify</a><ul>
<li><a href="#Modify_Parameters">Parameters</a></li>
<li><a href="#Modify_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#delete">Delete</a><ul>
<li><a href="#Delete_Parameters">Parameters</a></li>
</ul>
</li>
<li><a href="#getselection">GetSelection</a><ul>
<li><a href="#GetSelection_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#getcount">GetCount</a><ul>
<li><a href="#GetCount_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#getparent">GetParent</a><ul>
<li><a href="#GetParent_Parameters">Parameters</a></li>
<li><a href="#GetParent_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#getchild">GetChild</a><ul>
<li><a href="#GetChild_Parameters">Parameters</a></li>
<li><a href="#GetChild_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#getprev">GetPrev</a><ul>
<li><a href="#GetPrev_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#getnext">GetNext</a><ul>
<li><a href="#GetNext_Parameters">Parameters</a></li>
<li><a href="#GetNext_Return_Value">Return Value</a></li>
<li><a href="#GetNext_Remarks">Remarks</a></li>
</ul>
</li>
<li><a href="#gettext">GetText</a><ul>
<li><a href="#GetText_Parameters">Parameters</a></li>
<li><a href="#GetText_Return_Value">Return Value</a></li>
</ul>
</li>
<li><a href="#get">Get</a><ul>
<li><a href="#Get_Parameters">Parameters</a></li>
<li><a href="#Get_Return_Value">Return Value</a></li>
<li><a href="#Get_Remarks">Remarks</a></li>
</ul>
</li>
<li><a href="#setimagelist">SetImageList</a><ul>
<li><a href="#SetImageList_Parameters">Parameters</a></li>
<li><a href="#SetImageList_Return_Value">Return Value</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Events">Events</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script>
        // Set base URL for JavaScript modules
        window.BASE_URL = '/AHKv2_Docs';
    </script>
    <script src="/AHKv2_Docs/js/theme.js"></script>
    <script src="/AHKv2_Docs/js/sidebar.js"></script>
    <script src="/AHKv2_Docs/js/search.js"></script>
    <script src="/AHKv2_Docs/js/toc.js"></script>
    <script src="/AHKv2_Docs/js/syntax.js"></script>
</body>
</html>