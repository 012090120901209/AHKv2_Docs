<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#DllLoad | AutoHotkey v2 Documentation</title>
    <meta name="description" content="[Loads](DllCall.htm#load) a DLL or EXE file before the script starts">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/guides/Tutorial.html">Tutorial</a></li>
                            <li><a href="/guides/FAQ.html">FAQ</a></li>
                            <li><a href="/guides/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/functions/string/">String Functions</a></li>
                            <li><a href="/functions/window/">Window Functions</a></li>
                            <li><a href="/functions/file/">File Operations</a></li>
                            <li><a href="/functions/system/">System Functions</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/objects/Array.html">Array</a></li>
                            <li><a href="/objects/Map.html">Map</a></li>
                            <li><a href="/objects/Object.html">Object</a></li>
                            <li><a href="/objects/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/directives/_Include.html">#Include</a></li>
                            <li><a href="/directives/_Requires.html">#Requires</a></li>
                            <li><a href="/directives/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/reference/KeyList.html">Key List</a></li>
                            <li><a href="/reference/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/reference/Variables.html">Variables</a></li>
                            <li><a href="/reference/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>_DllLoad</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="dllload">#DllLoad</h1>
<p><a href="DllCall.htm#load">Loads</a> a DLL or EXE file before the script starts
executing.</p>
<pre class="codehilite"><code class="language-Syntax">#DllLoad FileOrDirName
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>FileOrDirName</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The path of a file or directory as explained below. This must
[not]{.underline} contain double quotes (except for an optional pair
of double quotes surrounding the parameter), wildcards (<code>*</code> and <code>?</code>)
or <a href="../misc/EscapeChar.htm">escape sequences</a> other than semicolon
(<code>`;</code>).</p>
<p>Built-in variables may be used by enclosing them in percent signs
(for example, <code>#DllLoad "%A_ScriptDir%"</code>). Percent signs which are
not part of a valid variable reference are interpreted literally.
All built-in variables are valid, except for
<a href="../Variables.htm#Args">A_Args</a> and built-in classes.</p>
<p>Known limitation: When compiling a script, variables are evaluated
by the compiler and may differ from what the script would return
when it is finally executed. The following variables are supported:
<a href="../Variables.htm#AhkPath">A_AhkPath</a>,
<a href="../Variables.htm#AppData">A_AppData</a>,
<a href="../Variables.htm#AppDataCommon">A_AppDataCommon</a>,
<a href="../Variables.htm#ComputerName">A_ComputerName</a>,
<a href="../Variables.htm#ComSpec">A_ComSpec</a>,
<a href="../Variables.htm#Desktop">A_Desktop</a>,
<a href="../Variables.htm#DesktopCommon">A_DesktopCommon</a>,
<a href="../Variables.htm#IsCompiled">A_IsCompiled</a>,
<a href="../Variables.htm#LineFile">A_LineFile</a>,
<a href="../Variables.htm#MyDocuments">A_MyDocuments</a>,
<a href="../Variables.htm#ProgramFiles">A_ProgramFiles</a>,
<a href="../Variables.htm#Programs">A_Programs</a>,
<a href="../Variables.htm#ProgramsCommon">A_ProgramsCommon</a>,
<a href="../Variables.htm#ScriptDir">A_ScriptDir</a>,
<a href="../Variables.htm#ScriptFullPath">A_ScriptFullPath</a>,
<a href="../Variables.htm#ScriptName">A_ScriptName</a>,
<a href="../Variables.htm#Space">A_Space</a>,
<a href="../Variables.htm#StartMenu">A_StartMenu</a>,
<a href="../Variables.htm#StartMenuCommon">A_StartMenuCommon</a>,
<a href="../Variables.htm#Startup">A_Startup</a>,
<a href="../Variables.htm#StartupCommon">A_StartupCommon</a>,
<a href="../Variables.htm#Tab">A_Tab</a>, <a href="../Variables.htm#Temp">A_Temp</a>,
<a href="../Variables.htm#UserName">A_UserName</a>,
<a href="../Variables.htm#WinDir">A_WinDir</a>.</p>
<p><strong>File:</strong> The absolute or relative path to the DLL or EXE file to be
loaded. If a relative path is specified, the directive searches for
the file using the same search strategy as the system\'s function
<a href="https://learn.microsoft.com/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryw">LoadLibraryW</a>.
Note: <a href="SetWorkingDir.htm">SetWorkingDir</a> has no effect on #DllLoad
because #DllLoad is processed before the script begins executing.</p>
<p><strong>Directory:</strong> Specify a directory instead of a file to alter the
search strategy by all subsequent occurrences of #DllLoad which do
not specify an absolute path to a DLL or EXE. The new search
strategy is the same as if <em>Directory</em> was passed to the system\'s
function
<a href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-setdlldirectoryw">SetDllDirectoryW</a>.
If this parameter is omitted, the default search strategy is
restored.</p>
<p><strong>Note:</strong> This parameter is not an expression, but can be enclosed
in quote marks (either \'single\' or \"double\").</p>
</dd>
</dl>
<h2 id="Remarks">Remarks</h2>
<p>Once a DLL or EXE has been loaded by this directive it cannot be
unloaded by calling the system\'s function
<a href="https://learn.microsoft.com/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary">FreeLibrary</a>.
When the script is terminated, all loaded files are unloaded
automatically.</p>
<p>The file path may optionally be preceded by <code>*i</code> and a single space,
which causes the program to ignore any failure to load the file. This
option should be used only if the script is capable of executing despite
the failure, such as if the DLL or EXE is non-essential, or if the
script is designed to detect the failure. For example:</p>
<pre class="codehilite"><code>#DllLoad &quot;*i MyDLL&quot;
if !DllCall(&quot;GetModuleHandle&quot;, &quot;str&quot;, &quot;MyDLL&quot;)
    MsgBox &quot;Failed to load MyDLL!&quot;
</code></pre>

<p>If the <em>FileOrDirName</em> parameter specifies a DLL name without a path and
the file name extension is omitted, <em>.dll</em> is appended to the file name.
To prevent this, include a trailing period (.) in the file name.</p>
<p>Like other directives, #DllLoad cannot be executed conditionally.</p>
<h2 id="Related">Related</h2>
<p><a href="DllCall.htm">DllCall</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExBasic .ex}
<a class="ex_number" href="#ExBasic"></a> Loads a DLL file located in the current user\'s
\"My Documents\" folder before the script starts executing.</p>
<pre class="codehilite"><code>#DllLoad &quot;%A_MyDocuments%\MyDLL.dll&quot;
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/_DllLoad.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#dllload">#DllLoad</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/theme.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/syntax.js"></script>
</body>
</html>