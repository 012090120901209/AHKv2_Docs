<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveEject / DriveRetract | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Ejects or retracts the tray of the specified CD/DVD drive. DriveEject">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/markdown.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/guides/Tutorial.html">Tutorial</a></li>
                            <li><a href="/guides/FAQ.html">FAQ</a></li>
                            <li><a href="/guides/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/functions/string/">String Functions</a></li>
                            <li><a href="/functions/window/">Window Functions</a></li>
                            <li><a href="/functions/file/">File Operations</a></li>
                            <li><a href="/functions/system/">System Functions</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/objects/Array.html">Array</a></li>
                            <li><a href="/objects/Map.html">Map</a></li>
                            <li><a href="/objects/Object.html">Object</a></li>
                            <li><a href="/objects/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/directives/_Include.html">#Include</a></li>
                            <li><a href="/directives/_Requires.html">#Requires</a></li>
                            <li><a href="/directives/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/reference/KeyList.html">Key List</a></li>
                            <li><a href="/reference/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/reference/Variables.html">Variables</a></li>
                            <li><a href="/reference/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a> <i class="fas fa-chevron-right"></i> <span>DriveEject</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="driveeject-driveretract">DriveEject / DriveRetract</h1>
<p>Ejects or retracts the tray of the specified CD/DVD drive. DriveEject
can also eject a removable drive.</p>
<pre class="codehilite"><code class="language-Syntax">DriveEject Drive
DriveRetract Drive
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>Drive</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If omitted, it defaults to the first CD/DVD drive found by iterating
from A to Z (an exception is thrown if no drive is found).
Otherwise, specify the drive letter optionally followed by a colon
or a colon and backslash. For example, <code>"D"</code>, <code>"D:"</code> or <code>"D:\"</code>.</p>
<p>This can also be a device path in the form <code>"\\?\Volume{...}"</code>,
which can be discovered by running
<a href="https://learn.microsoft.com/windows-server/administration/windows-commands/mountvol">mountvol</a>
at the command line. In this case the drive is not required to be
assigned a drive letter.</p>
</dd>
</dl>
<h2 id="Error_Handling">Error Handling</h2>
<p>An exception is thrown on failure, if detected.</p>
<p>These functions will probably not work on a network drive or any drive
lacking the \"Eject\" option in Explorer. The underlying system
functions do not always report failure, so an exception may or may not
be thrown.</p>
<h2 id="Remarks">Remarks</h2>
<p>This function waits for the ejection or retraction to complete before
allowing the script to continue.</p>
<p>It may be possible to detect the previous tray state by measuring the
time the function takes to complete, as in <a href="#ExToggle">the example
below</a>.</p>
<p>Ejecting a removable drive is generally equivalent to using the
\"Eject\" context menu option in Explorer, except that no warning is
shown if files are in use. Unlike the Safely Remove Hardware option,
this only dismounts the volume identified by the <em>Drive</em> parameter, not
the overall device.</p>
<p>DriveEject and DriveRetract correspond to the
<a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ni-ntddstor-ioctl_storage_eject_media">IOCTL_STORAGE_EJECT_MEDIA</a>
and
<a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ni-ntddstor-ioctl_storage_load_media">IOCTL_STORAGE_LOAD_MEDIA</a>
control codes, which may also have an effect on drive types other than
CD/DVD, such as tape drives.</p>
<h2 id="Related">Related</h2>
<p><a href="DriveGetStatusCD.htm">DriveGetStatusCD</a>, <a href="Drive.htm">Drive functions</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExEject .ex}
<a class="ex_number" href="#ExEject"></a> Ejects (opens) the tray of the first CD/DVD
drive.</p>
<pre class="codehilite"><code>DriveEject()
</code></pre>

<p>:::</p>
<p>::: {#ExRetract .ex}
<a class="ex_number" href="#ExRetract"></a> Retracts (closes) the tray of the first
CD/DVD drive.</p>
<pre class="codehilite"><code>DriveRetract()
</code></pre>

<p>:::</p>
<p>::: {#ExEjectAll .ex}
<a class="ex_number" href="#ExEjectAll"></a> Ejects all removable drives (except CD/DVD
drives).</p>
<pre class="codehilite"><code>Loop Parse DriveGetList(&quot;REMOVABLE&quot;)
{
    if MsgBox(&quot;Eject &quot; A_LoopField &quot;:, even if files are open?&quot;,, &quot;y/n&quot;) = &quot;yes&quot;
        DriveEject(A_LoopField)
}
else
    MsgBox &quot;No removable drives found.&quot;
</code></pre>

<p>:::</p>
<p>::: {#ExToggle .ex}
<a class="ex_number" href="#ExToggle"></a> Defines a hotkey which toggles the tray to the
opposite state (open or closed), based on the time the function takes to
complete.</p>
<pre class="codehilite"><code>#c::
{
    DriveEject
    ; If the function completed quickly, the tray was probably already ejected.
    ; In that case, retract it:
    if (A_TimeSinceThisHotkey &lt; 1000)  ; Adjust this time if needed.
        DriveRetract
}
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/DriveEject.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#driveeject-driveretract">DriveEject / DriveRetract</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Error_Handling">Error Handling</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/theme.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/syntax.js"></script>
</body>
</html>