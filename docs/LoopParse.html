<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loop Parse | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Retrieves substrings (fields) from a string, one at a time.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/AHKv2_Docs/css/styles.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/sidebar.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/markdown.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/AHKv2_Docs/" class="navbar-brand">
                    <span class="logo-icon">⚡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Tutorial.html">Tutorial</a></li>
                            <li><a href="/AHKv2_Docs/FAQ.html">FAQ</a></li>
                            <li><a href="/AHKv2_Docs/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Functions.html">Functions</a></li>
                            <li><a href="/AHKv2_Docs/StrLen.html">String Functions</a></li>
                            <li><a href="/AHKv2_Docs/WinActivate.html">Window Functions</a></li>
                            <li><a href="/AHKv2_Docs/FileRead.html">File Operations</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Array.html">Array</a></li>
                            <li><a href="/AHKv2_Docs/Map.html">Map</a></li>
                            <li><a href="/AHKv2_Docs/Object.html">Object</a></li>
                            <li><a href="/AHKv2_Docs/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/_Include.html">#Include</a></li>
                            <li><a href="/AHKv2_Docs/_Requires.html">#Requires</a></li>
                            <li><a href="/AHKv2_Docs/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/KeyList.html">Key List</a></li>
                            <li><a href="/AHKv2_Docs/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/AHKv2_Docs/Variables.html">Variables</a></li>
                            <li><a href="/AHKv2_Docs/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/AHKv2_Docs/">Home</a> <i class="fas fa-chevron-right"></i> <span>LoopParse</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="loop-parse">Loop Parse</h1>
<p>Retrieves substrings (fields) from a string, one at a time.</p>
<pre class="codehilite"><code class="language-Syntax">Loop Parse String , DelimiterChars, OmitChars
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>String</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The string to analyze.</p>
</dd>
<dt>DelimiterChars</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If blank or omitted, each character of the input string will be
treated as a separate substring.</p>
<p>If this parameter is <code>"CSV"</code>, the string will be parsed in standard
comma separated value format. Here is an example of a CSV line
produced by MS Excel:</p>
<p><code>no-highlight
"first field",SecondField,"the word ""special"" is quoted literally",,"last field, has literal comma"</code></p>
<p>Otherwise, specify one or more characters (case-sensitive), each of
which is used to determine where the boundaries between substrings
occur.</p>
<p>Delimiter characters are not considered to be part of the substrings
themselves. In addition, if there is nothing between a pair of
delimiter characters within the input string, the corresponding
substring will be empty.</p>
<p>For example: <code>','</code> (a comma) would divide the string based on every
occurrence of a comma. Similarly, <code>A_Space A_Tab</code> would start a new
substring every time a space or tab is encountered in the input
string.</p>
<p>To use a string as a delimiter rather than a character, first use
<a href="StrReplace.htm">StrReplace</a> to replace all occurrences of the
string with a single character that is never used literally in the
text, e.g. one of these special characters: <code>¢¤¥¦§©ª«®µ¶</code>. Consider
this example, which uses the string \&lt;br&gt; as a delimiter:</p>
<pre class="codehilite"><code>NewHTML := StrReplace(HTMLString, &quot;&lt;br&gt;&quot;, &quot;¢&quot;)
Loop Parse, NewHTML, &quot;¢&quot; ; Parse the string based on the cent symbol.
{
    ; ...
}
</code></pre>

</dd>
<dt>OmitChars</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>If blank or omitted, no characters will be excluded. Otherwise,
specify a list of characters (case-sensitive) to exclude from the
beginning and end of each substring. For example, if <em>OmitChars</em> is
<code>A_Space A_Tab</code>, spaces and tabs will be removed from the beginning
and end (but not the middle) of every retrieved substring.</p>
<p>If <em>DelimiterChars</em> is blank, <em>OmitChars</em> indicates which characters
should be excluded from consideration (the loop will not see them).</p>
</dd>
</dl>
<h2 id="Remarks">Remarks</h2>
<p>A string parsing loop is useful when you want to operate on each field
contained in a string, one at a time. Parsing loops use less memory than
<a href="StrSplit.htm">StrSplit</a> (though either way the memory use is temporary)
and in most cases they are easier to use.</p>
<p>The built-in variable <strong>A_LoopField</strong> exists within any parsing loop. It
contains the contents of the current substring (field). If an inner
parsing loop is enclosed by an outer parsing loop, the innermost loop\'s
field will take precedence.</p>
<p>Although there is no built-in variable \"A_LoopDelimiter\", the example
at the very bottom of this page demonstrates how to detect which
delimiter character was encountered for each field.</p>
<p>There is no restriction on the size of the input string or its fields.</p>
<p>To arrange the fields in a different order prior to parsing, use the
<a href="Sort.htm">Sort</a> function.</p>
<p>See <a href="Loop.htm">Loop</a> for information about <a href="Block.htm">Blocks</a>,
<a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a>, and the A_Index variable
(which exists in every type of loop).</p>
<p>The loop may optionally be followed by an <a href="Else.htm">Else</a> statement,
which is executed if the loop had zero iterations. Note that the loop
always has at least one iteration unless <em>String</em> is empty or
<em>DelimiterChars</em> is omitted and all characters in <em>String</em> are included
in <em>OmitChars</em>.</p>
<h2 id="Related">Related</h2>
<p><a href="StrSplit.htm">StrSplit</a>, <a href="LoopRead.htm">file-reading loop</a>,
<a href="Loop.htm">Loop</a>, <a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a>,
<a href="Block.htm">Blocks</a>, <a href="Sort.htm">Sort</a>,
<a href="FileSetAttrib.htm">FileSetAttrib</a>, <a href="FileSetTime.htm">FileSetTime</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExBasic .ex}
<a class="ex_number" href="#ExBasic"></a> Parses a comma-separated string.</p>
<pre class="codehilite"><code>Colors := &quot;red,green,blue&quot;
Loop parse, Colors, &quot;,&quot;
{
    MsgBox &quot;Color number &quot; A_Index &quot; is &quot; A_LoopField
}
</code></pre>

<p>:::</p>
<p>::: {#ExFileRead .ex}
<a class="ex_number" href="#ExFileRead"></a> Reads the lines inside a variable, one by
one (similar to a <a href="LoopRead.htm">file-reading loop</a>). A file can be
loaded into a variable via <a href="FileRead.htm">FileRead</a>.</p>
<pre class="codehilite"><code>Loop parse, FileContents, &quot;`n&quot;, &quot;`r&quot;  ; Specifying `n prior to `r allows both Windows and Unix files to be parsed.
{
    Result := MsgBox(&quot;Line number &quot; A_Index &quot; is &quot; A_LoopField &quot;.`n`nContinue?&quot;,, &quot;y/n&quot;)
}
until Result = &quot;No&quot;
</code></pre>

<p>:::</p>
<p>::: {#ExClipboard .ex}
<a class="ex_number" href="#ExClipboard"></a> This is the same as the example above
except that it\'s for the <a href="A_Clipboard.htm">clipboard</a>. It\'s useful
whenever the clipboard contains files, such as those copied from an open
Explorer window (the program automatically converts such files to their
file names).</p>
<pre class="codehilite"><code>Loop parse, A_Clipboard, &quot;`n&quot;, &quot;`r&quot;
{
    Result := MsgBox(&quot;File number &quot; A_Index &quot; is &quot; A_LoopField &quot;.`n`nContinue?&quot;,, &quot;y/n&quot;)
}
until Result = &quot;No&quot;
</code></pre>

<p>:::</p>
<p>::: {#ExCSV .ex}
<a class="ex_number" href="#ExCSV"></a> Parses a comma separated value (CSV) file.</p>
<pre class="codehilite"><code>Loop read, &quot;C:\Database Export.csv&quot;
{
    LineNumber := A_Index
    Loop parse, A_LoopReadLine, &quot;CSV&quot;
    {
        Result := MsgBox(&quot;Field &quot; LineNumber &quot;-&quot; A_Index &quot; is:`n&quot; A_LoopField &quot;`n`nContinue?&quot;,, &quot;y/n&quot;)
        if Result = &quot;No&quot;
            return
    }
}
</code></pre>

<p>:::</p>
<p>::: {#ExDelimiter .ex}
<a class="ex_number" href="#ExDelimiter"></a> Determines which delimiter character was
encountered.</p>
<pre class="codehilite"><code>; Initialize string to search.
Colors := &quot;red,green|blue;yellow|cyan,magenta&quot;
; Initialize counter to keep track of our position in the string.
Position := 0

Loop Parse, Colors, &quot;,|;&quot;
{
    ; Calculate the position of the delimiter character at the end of this field.
    Position += StrLen(A_LoopField) + 1
    ; Retrieve the delimiter character found by the parsing loop.
    DelimiterChar := SubStr(Colors, Position, 1)

    MsgBox &quot;Field: &quot; A_LoopField &quot;`nDelimiter character: &quot; DelimiterChar
}
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/LoopParse.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#loop-parse">Loop Parse</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script>
        // Set base URL for JavaScript modules
        window.BASE_URL = '/AHKv2_Docs';
    </script>
    <script src="/AHKv2_Docs/js/theme.js"></script>
    <script src="/AHKv2_Docs/js/sidebar.js"></script>
    <script src="/AHKv2_Docs/js/search.js"></script>
    <script src="/AHKv2_Docs/js/toc.js"></script>
    <script src="/AHKv2_Docs/js/syntax.js"></script>
</body>
</html>