<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnEvent | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Registers a function or method to be called when the given event is">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/AHKv2_Docs/css/styles.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/sidebar.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/markdown.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/AHKv2_Docs/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Tutorial.html">Tutorial</a></li>
                            <li><a href="/AHKv2_Docs/FAQ.html">FAQ</a></li>
                            <li><a href="/AHKv2_Docs/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Functions.html">Functions</a></li>
                            <li><a href="/AHKv2_Docs/StrLen.html">String Functions</a></li>
                            <li><a href="/AHKv2_Docs/WinActivate.html">Window Functions</a></li>
                            <li><a href="/AHKv2_Docs/FileRead.html">File Operations</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Array.html">Array</a></li>
                            <li><a href="/AHKv2_Docs/Map.html">Map</a></li>
                            <li><a href="/AHKv2_Docs/Object.html">Object</a></li>
                            <li><a href="/AHKv2_Docs/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/_Include.html">#Include</a></li>
                            <li><a href="/AHKv2_Docs/_Requires.html">#Requires</a></li>
                            <li><a href="/AHKv2_Docs/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/KeyList.html">Key List</a></li>
                            <li><a href="/AHKv2_Docs/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/AHKv2_Docs/Variables.html">Variables</a></li>
                            <li><a href="/AHKv2_Docs/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/AHKv2_Docs/">Home</a> <i class="fas fa-chevron-right"></i> <span>GuiOnEvent</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="onevent">OnEvent</h1>
<p>Registers a function or method to be called when the given event is
raised by a GUI window or control.</p>
<pre class="codehilite"><code class="language-Syntax">Gui.OnEvent(EventName, Callback , AddRemove)
GuiCtrl.OnEvent(EventName, Callback , AddRemove)
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>EventName</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>The name of the event. See <a href="#Events">Events</a> further below.</p>
</dd>
<dt>Callback</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a> or <a href="../misc/Functor.htm">Function
Object</a></p>
<p>The function, method or object to call when the event is raised.</p>
<p>If the GUI has an event sink (that is, if <a href="Gui.htm#Call">Gui()</a>\'s
<em>EventObj</em> parameter was specified), this parameter may be the name
of a method belonging to the event sink. Otherwise, this parameter
must be a <a href="../misc/Functor.htm">function object</a>.</p>
<p>For details about the parameters, return value, naming, and more,
see the following sections.</p>
</dd>
<dt>AddRemove</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 1. Otherwise, specify one of the
following numbers:</p>
<ul>
<li>1 = Call the callback after any previously registered callbacks.</li>
<li>-1 = Call the callback before any previously registered
    callbacks.</li>
<li>0 = Do not call the callback.</li>
</ul>
</dd>
</dl>
<h2 id="Callback_Parameters">Callback Parameters</h2>
<p>If the callback is a method registered by name, its hidden <a href="../Objects.htm#Custom_Classes_method"><em>this</em>
parameter</a> seamlessly receives the
event sink object (that is, the object to which the method belongs).
This parameter is not shown in the parameter lists in this
documentation.</p>
<p>Since <em>Callback</em> can be an object, it can be a <a href="../misc/Functor.htm#BoundFunc">BoundFunc
object</a> which inserts additional
parameters at the beginning of the parameter list and then calls another
function. This is a general technique not specific to OnEvent, so is
generally ignored by the rest of this documentation.</p>
<p>The callback\'s first explicit parameter is the <a href="Gui.htm">Gui</a> or
<a href="GuiControl.htm">GuiControl</a> object which raised the event. The only
exception is that this parameter is omitted when a Gui <a href="Gui.htm#EventObj">handles its own
events</a>, since <code>this</code> already contains a reference to
the Gui.</p>
<p>Many events pass additional parameters about the event, as described for
each event.</p>
<p>As with all methods or functions called dynamically, the callback is not
required to declare parameters which the callback itself does not need,
but in this case an asterisk must be specified as the final parameter,
e.g. <code>MyCallback(Param1, *)</code>. If an event has more parameters than are
declared by the callback, they will simply be ignored (unless the
callback is <a href="../Functions.htm#Variadic">variadic</a>).</p>
<p>The callback can declare more parameters than the event provides if (and
only if) the additional parameters are declared optional. However, the
use of optional parameters is not recommended as future versions of the
program may extend an event with additional parameters, in which case
the optional parameters would stop receiving their default values.</p>
<h2 id="Callback_Return_Value">Callback Return Value</h2>
<p>If multiple callbacks have been registered for an event, a callback may
return a non-empty value to prevent any remaining callbacks from being
called.</p>
<p>The return value may have additional meaning for specific events. For
example, a <a href="#Close">Close</a> callback may return a non-zero number (such
as <code>true</code>) to prevent the GUI window from closing.</p>
<h2 id="Callback_Name">Callback Name</h2>
<p>By convention, the syntax of each event below is shown with a function
name of the form <em><code>ObjectType</code></em><code>_</code><em><code>EventName</code></em>, for clarity. Scripts
are not required to follow this convention, and can use any valid
function name.</p>
<h2 id="Threads">Threads</h2>
<p>Each event callback is called in a new <a href="../misc/Threads.htm">thread</a>,
and therefore starts off fresh with the default values for settings such
as <a href="SendMode.htm">SendMode</a>. These defaults can be changed during
<a href="../Scripts.htm#auto">script startup</a>.</p>
<p>Whenever a GUI <a href="../misc/Threads.htm">thread</a> is launched, that thread\'s
<a href="../misc/WinTitle.htm#LastFoundWindow">last found window</a> starts off as
the GUI window itself. This allows functions for windows and controls
-- such as <a href="WinGetStyle.htm">WinGetStyle</a>,
<a href="WinSetTransparent.htm">WinSetTransparent</a>, and
<a href="ControlGetFocus.htm">ControlGetFocus</a> -- to omit <em>WinTitle</em> and
<em>WinText</em> when operating upon the GUI window itself (even if it is
hidden).</p>
<p>Except where noted, each event is limited to one thread at a time, per
object. If an event is raised before a previous thread started by that
event finishes, it is usually discarded. To prevent this, use
<a href="Critical.htm">Critical</a> as the callback\'s first line (however, this
will also buffer/defer other <a href="../misc/Threads.htm">threads</a> such as the
press of a hotkey).</p>
<h2 id="Destroying_the_GUI">Destroying the GUI</h2>
<p>When a GUI is destroyed, all event callbacks are released. Therefore, if
the GUI is destroyed while an event is being dispatched, subsequent
event callbacks are not called. For clarity, callbacks should <a href="#Callback_Return_Value">return a
non-empty value</a> after destroying the GUI.</p>
<h2 id="Events">Events</h2>
<p>The following events are supported by <a href="Gui.htm">Gui</a> objects:</p>
<p>Event                         Raised when...</p>
<hr />
<p><a href="#Close">Close</a>               The window is closed.
  <a href="#ContextMenu">ContextMenu</a>   The user right-clicks within the window or presses [Menu]{.kbd} or [Shift]{.kbd}+[F10]{.kbd}.
  <a href="#DropFiles">DropFiles</a>       Files/folders are dragged and dropped onto the window.
  <a href="#Escape">Escape</a>             The user presses [Esc]{.kbd} while the GUI window is active.
  <a href="#Size">Size</a>                 The window is resized, minimized, maximized or restored.</p>
<p>The following events are supported by <a href="GuiControl.htm">GuiControl</a>
objects, depending on the control type:</p>
<p>Event                              Raised when...</p>
<hr />
<p><a href="#Change">Change</a>                  The control\'s value changes.
  <a href="#Click">Click</a>                    The control is clicked.
  <a href="#DoubleClick">DoubleClick</a>        The control is double-clicked.
  <a href="#ColClick">ColClick</a>              One of the ListView\'s column headers is clicked.
  <a href="#Ctrl-ContextMenu">ContextMenu</a>   The user right-clicks the control or presses [Menu]{.kbd} or [Shift]{.kbd}+[F10]{.kbd} while the control has the keyboard focus.
  <a href="#Focus">Focus</a>                    The control gains the keyboard focus.
  <a href="#LoseFocus">LoseFocus</a>            The control loses the keyboard focus.
  <a href="#ItemCheck">ItemCheck</a>            A ListView or TreeView item is checked or unchecked.
  <a href="#ItemEdit">ItemEdit</a>              A ListView or TreeView item\'s label is edited by the user.
  <a href="#ItemExpand">ItemExpand</a>          A TreeView item is expanded or collapsed.
  <a href="#ItemFocus">ItemFocus</a>            The focused item changes in a ListView.
  <a href="#ItemSelect">ItemSelect</a>          A ListView or TreeView item is selected, or a ListView item is deselected.</p>
<h2 id="Window_Events">Window Events</h2>
<h3 id="Close">Close</h3>
<p>Launched when the user or another program attempts to close the window,
such as by pressing the X button in its title bar, selecting \"Close\"
from its system menu, or calling <a href="WinClose.htm">WinClose</a>.</p>
<pre class="codehilite"><code class="language-Syntax">Gui_Close(GuiObj)
</code></pre>

<p>By default, the window is automatically hidden after the callback
returns, or if no callbacks were registered. A callback can prevent this
by returning 1 (or <code>true</code>), which will also prevent any remaining
callbacks from being called. The callback can hide the window
immediately by calling <a href="Gui.htm#Hide">GuiObj.Hide</a>, or destroy the
window by calling <a href="Gui.htm#Destroy">GuiObj.Destroy</a>.</p>
<p>For example, this GUI shows a confirmation prompt before closing:</p>
<pre class="codehilite"><code>MyGui := Gui()
MyGui.AddText(&quot;&quot;, &quot;Press Alt+F4 or the X button in the title bar.&quot;)
MyGui.OnEvent(&quot;Close&quot;, MyGui_Close)
MyGui_Close(thisGui) {  ; Declaring this parameter is optional.
    if MsgBox(&quot;Are you sure you want to close the GUI?&quot;,, &quot;y/n&quot;) = &quot;No&quot;
        return true  ; true = 1
}
MyGui.Show()
</code></pre>

<h3 id="ContextMenu">ContextMenu</h3>
<p>Launched whenever the user right-clicks anywhere in the window except
the title bar and menu bar. It is also launched in response to pressing
[Menu]{.kbd} or [Shift]{.kbd}+[F10]{.kbd}.</p>
<pre class="codehilite"><code class="language-Syntax">Gui_ContextMenu(GuiObj, GuiCtrlObj, Item, IsRightClick, X, Y)
</code></pre>

<dl>
<dt>GuiCtrlObj</dt>
<dd>
<p>Type: <a href="../Concepts.htm#objects">Object</a> or <a href="../Concepts.htm#nothing">String
(empty)</a></p>
<p>The <a href="GuiControl.htm">GuiControl object</a> of the control that received
the event (blank if none).</p>
</dd>
<dt>Item</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>When a ListBox, ListView, or TreeView is the target of the context
menu (as determined by <em>GuiCtrlObj</em>), <em>Item</em> specifies which of the
control\'s items is the target.</p>
<p><a href="GuiControls.htm#ListBox">ListBox</a>: The position number of the
currently focused item. Note that a standard ListBox does not focus
an item when it is right-clicked, so this might not be the clicked
item.</p>
<p><a href="ListView.htm">ListView</a> and <a href="TreeView.htm">TreeView</a>: For
right-clicks, <em>Item</em> contains the clicked item\'s row number or ID
(or 0 if the user clicked somewhere other than an item). For
[Menu]{.kbd} and [Shift]{.kbd}+[F10]{.kbd}, <em>Item</em> contains the
selected item\'s row number or ID.</p>
</dd>
<dt>IsRightClick</dt>
<dd>
<p>Type: <a href="../Concepts.htm#boolean">Integer (boolean)</a></p>
<p>One of the following values:</p>
<ul>
<li>1 (true) = The user clicked the right mouse button.</li>
<li>0 (false) = The user pressed [Menu]{.kbd} or
    [Shift]{.kbd}+[F10]{.kbd}.</li>
</ul>
</dd>
<dt>X, Y</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The X and Y coordinates of where the script should display the menu
(e.g. <code>MyContextMenu.</code><a href="Menu.htm#Show"><code>Show</code></a><code>X, Y</code>). Coordinates
are relative to the upper-left corner of the window\'s client area.</p>
</dd>
</dl>
<p>Unlike most other GUI events, the ContextMenu event can have more than
one concurrent <a href="../misc/Threads.htm">thread</a>.</p>
<p>Each control can have its own ContextMenu event callback which is called
before any callback registered for the Gui object. Control-specific
callbacks omit the <em>GuiObj</em> parameter, but all other parameters are the
same.</p>
<p>Note: Since <a href="GuiControls.htm#Edit">Edit</a> and
<a href="GuiControls.htm#MonthCal">MonthCal</a> controls have their own context
menu, a right-click in one of them will not launch the ContextMenu
event.</p>
<h3 id="DropFiles">DropFiles</h3>
<p>Launched whenever files/folders are dropped onto the window as part of a
drag-and-drop operation (but if this callback is already running, drop
events are ignored).</p>
<pre class="codehilite"><code class="language-Syntax">Gui_DropFiles(GuiObj, GuiCtrlObj, FileArray, X, Y)
</code></pre>

<dl>
<dt>GuiCtrlObj</dt>
<dd>
<p>Type: <a href="../Concepts.htm#objects">Object</a> or <a href="../Concepts.htm#nothing">String
(empty)</a></p>
<p>The <a href="GuiControl.htm">GuiControl object</a> of the control upon which
the files were dropped (blank if none).</p>
</dd>
<dt>FileArray</dt>
<dd>
<p>Type: <a href="Array.htm">Array</a></p>
<p>An array of filenames, where <code>FileArray[1]</code> is the first file and
<code>FileArray.Length</code> returns the number of files. A
<a href="For.htm">for-loop</a> can be used to iterate through the files:</p>
<pre class="codehilite"><code>Gui_DropFiles(GuiObj, GuiCtrlObj, FileArray, X, Y) {
    for i, DroppedFile in FileArray
        MsgBox &quot;File &quot; i &quot; is:`n&quot; DroppedFile
}
</code></pre>

</dd>
<dt>X, Y</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The X and Y coordinates of where the files were dropped, relative to
the upper-left corner of the window\'s client area.</p>
</dd>
</dl>
<h3 id="Escape">Escape</h3>
<p>Launched when the user presses [Esc]{.kbd} while the GUI window is
active.</p>
<pre class="codehilite"><code class="language-Syntax">Gui_Escape(GuiObj)
</code></pre>

<p>By default, pressing [Esc]{.kbd} has no effect. Known limitation: If the
first control in the window is disabled (possibly depending on control
type), the Escape event will not be launched. There may be other
circumstances that produce this effect.</p>
<h3 id="Size">Size</h3>
<p>Launched when the window is resized, minimized, maximized, or restored.</p>
<pre class="codehilite"><code class="language-Syntax">Gui_Size(GuiObj, MinMax, Width, Height)
</code></pre>

<dl>
<dt>MinMax</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>One of the following values:</p>
<ul>
<li>0 = The window is neither minimized nor maximized.</li>
<li>1 = The window is maximized.</li>
<li>-1 = The window is minimized.</li>
</ul>
<p>Note that a maximized window can be resized without
restoring/un-maximizing it, so a value of 1 does not necessarily
mean that this event was raised in response to the user maximizing
the window.</p>
</dd>
<dt>Width, Height</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The new width and height of the window\'s client area, which is the
area excluding title bar, menu bar, and borders.</p>
</dd>
</dl>
<p>A script may use the Size event to reposition and resize controls in
response to the user\'s resizing of the window.</p>
<p>When the window is resized (even by the script), the Size event might
not be raised immediately. As with other window events, if the current
thread is <a href="Thread.htm#Interrupt">uninterruptible</a>, the Size event won\'t
be raised until the thread becomes interruptible. If the script has just
resized the window, follow this example to ensure the Size event is
raised immediately:</p>
<pre class="codehilite"><code>Critical &quot;Off&quot;  ; Even if Critical &quot;On&quot; was never used.
Sleep -1
</code></pre>

<p><a href="Gui.htm#Show">Gui.Show</a> automatically does a <code>Sleep -1</code>, so it is
generally not necessary to call Sleep in that case.</p>
<h2 id="Control_Events">Control Events</h2>
<h3 id="Change">Change</h3>
<p>Raised when the control\'s value changes.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_Change(GuiCtrlObj, Info)
</code></pre>

<dl>
<dt>Info</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p><a href="GuiControls.htm#Slider">Slider</a>: A numeric value indicating how the
slider moved. For details, see <a href="GuiControls.htm#slider-change">Detecting
Changes</a>.</p>
<p>For all other controls, <em>Info</em> currently has no meaning.</p>
</dd>
</dl>
<p>To retrieve the control\'s new value, use
<a href="GuiControl.htm#Value">GuiCtrlObj.Value</a>.</p>
<p>Applies to: <a href="GuiControls.htm#DDL">DDL</a>,
<a href="GuiControls.htm#ComboBox">ComboBox</a>,
<a href="GuiControls.htm#ListBox">ListBox</a>, <a href="GuiControls.htm#Edit">Edit</a>,
<a href="GuiControls.htm#DateTime">DateTime</a>,
<a href="GuiControls.htm#MonthCal">MonthCal</a>, <a href="GuiControls.htm#Hotkey">Hotkey</a>,
<a href="GuiControls.htm#UpDown">UpDown</a>, <a href="GuiControls.htm#Slider">Slider</a>,
<a href="GuiControls.htm#Tab">Tab</a>.</p>
<h3 id="Click">Click</h3>
<p>Raised when the control is clicked.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_Click(GuiCtrlObj, Info)
Link_Click(GuiCtrlObj, Info, Href)
</code></pre>

<dl>
<dt>Info</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p><a href="GuiControls.htm#ListView">ListView</a>: The row number of the clicked
item, or 0 if the mouse was not over an item.</p>
<p><a href="GuiControls.htm#TreeView">TreeView</a>: The ID of the clicked item, or
0 if the mouse was not over an item.</p>
<p><a href="GuiControls.htm#Link">Link</a>: The link\'s ID attribute (a string) if
it has one, otherwise the link\'s index (an integer).</p>
<p><a href="GuiControls.htm#StatusBar">StatusBar</a>: The part number of the
clicked section (however, the part number might be a very large
integer if the user clicks near the sizing grip at the right side of
the bar).</p>
<p>For all other controls, <em>Info</em> currently has no meaning.</p>
</dd>
<dt>Href</dt>
<dd>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p><a href="GuiControls.htm#Link">Link</a>: The link\'s HREF attribute. Note that
if a Click event callback is registered, the HREF attribute is not
automatically executed.</p>
</dd>
</dl>
<p>Applies to: <a href="GuiControls.htm#Text">Text</a>, <a href="GuiControls.htm#Pic">Pic</a>,
<a href="GuiControls.htm#Button">Button</a>, <a href="GuiControls.htm#CheckBox">CheckBox</a>,
<a href="GuiControls.htm#Radio">Radio</a>, <a href="ListView.htm">ListView</a>,
<a href="TreeView.htm">TreeView</a>, <a href="GuiControls.htm#Link">Link</a>,
<a href="GuiControls.htm#StatusBar">StatusBar</a>.</p>
<h3 id="DoubleClick">DoubleClick</h3>
<p>Raised when the control is double-clicked.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_DoubleClick(GuiCtrlObj, Info)
</code></pre>

<dl>
<dt>Info</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p><a href="GuiControls.htm#ListView">ListView</a>,
<a href="GuiControls.htm#TreeView">TreeView</a> and
<a href="GuiControls.htm#StatusBar">StatusBar</a>: Same as for the
<a href="#Click">Click</a> event.</p>
<p><a href="GuiControls.htm#ListBox">ListBox</a>: The position number of the
currently focused item. Double-clicking empty space below the last
item usually focuses the last item and leaves the selection as it
was.</p>
</dd>
</dl>
<p>Applies to: <a href="GuiControls.htm#Text">Text</a>, <a href="GuiControls.htm#Pic">Pic</a>,
<a href="GuiControls.htm#Button">Button</a>, <a href="GuiControls.htm#CheckBox">CheckBox</a>,
<a href="GuiControls.htm#Radio">Radio</a>, <a href="GuiControls.htm#ComboBox">ComboBox</a>,
<a href="GuiControls.htm#ListBox">ListBox</a>, <a href="ListView.htm">ListView</a>,
<a href="TreeView.htm">TreeView</a>, <a href="GuiControls.htm#StatusBar">StatusBar</a>.</p>
<h3 id="ColClick">ColClick</h3>
<p>Raised when one of the ListView\'s column headers is clicked.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ColClick(GuiCtrlObj, Info)
</code></pre>

<dl>
<dt>Info</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The one-based column number that was clicked. This is the original
number assigned when the column was created; that is, it does not
reflect any dragging and dropping of columns done by the user.</p>
</dd>
</dl>
<p>Applies to: <a href="ListView.htm">ListView</a>.</p>
<h3 id="Ctrl-ContextMenu">ContextMenu</h3>
<p>Raised when the user right-clicks the control or presses [Menu]{.kbd} or
[Shift]{.kbd}+[F10]{.kbd} while the control has the keyboard focus.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ContextMenu(GuiCtrlObj, Item, IsRightClick, X, Y)
</code></pre>

<p>For details, see <a href="#ContextMenu">ContextMenu</a>.</p>
<p>Applies to: All controls except <a href="GuiControls.htm#Edit">Edit</a> and
<a href="GuiControls.htm#MonthCal">MonthCal</a> (and the Edit control within a
<a href="GuiControls.htm#ComboBox">ComboBox</a>), which have their own standard
context menu.</p>
<p>[]{#LoseFocus}</p>
<h3 id="Focus">Focus / LoseFocus</h3>
<p>Raised when the control gains or loses the keyboard focus.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_Focus(GuiCtrlObj, Info)
Ctrl_LoseFocus(GuiCtrlObj, Info)
</code></pre>

<dl>
<dt>Info</dt>
<dd>
<p>Reserved.</p>
</dd>
</dl>
<p>Applies to: <a href="GuiControls.htm#Button">Button</a>,
<a href="GuiControls.htm#CheckBox">CheckBox</a>, <a href="GuiControls.htm#Radio">Radio</a>,
<a href="GuiControls.htm#DDL">DDL</a>, <a href="GuiControls.htm#ComboBox">ComboBox</a>,
<a href="GuiControls.htm#ListBox">ListBox</a>, <a href="ListView.htm">ListView</a>,
<a href="TreeView.htm">TreeView</a>, <a href="GuiControls.htm#Edit">Edit</a>,
<a href="GuiControls.htm#DateTime">DateTime</a>.</p>
<p>Not supported: <a href="GuiControls.htm#Hotkey">Hotkey</a>,
<a href="GuiControls.htm#Slider">Slider</a>, <a href="GuiControls.htm#Tab">Tab</a> and
<a href="GuiControls.htm#Link">Link</a>. Note that <a href="GuiControls.htm#Text">Text</a>,
<a href="GuiControls.htm#Pic">Pic</a>, <a href="GuiControls.htm#MonthCal">MonthCal</a>,
<a href="GuiControls.htm#UpDown">UpDown</a> and
<a href="GuiControls.htm#StatusBar">StatusBar</a> controls do not accept the
keyboard focus.</p>
<h3 id="ItemCheck">ItemCheck</h3>
<p>Raised when a ListView or TreeView item is checked or unchecked.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ItemCheck(GuiCtrlObj, Item, Checked)
</code></pre>

<p>Applies to: <a href="ListView.htm">ListView</a>, <a href="TreeView.htm">TreeView</a>.</p>
<h3 id="ItemEdit">ItemEdit</h3>
<p>Raised when a ListView or TreeView item\'s label is edited by the user.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ItemEdit(GuiCtrlObj, Item)
</code></pre>

<p>An item\'s label can only be edited if <code>-ReadOnly</code> has been used in the
control\'s options.</p>
<p>Applies to: <a href="ListView.htm">ListView</a>, <a href="TreeView.htm">TreeView</a>.</p>
<h3 id="ItemExpand">ItemExpand</h3>
<p>Raised when a TreeView item is expanded or collapsed.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ItemExpand(GuiCtrlObj, Item, Expanded)
</code></pre>

<p>Applies to: <a href="TreeView.htm">TreeView</a>.</p>
<h3 id="ItemFocus">ItemFocus</h3>
<p>Raised when the focused item changes in a ListView.</p>
<pre class="codehilite"><code class="language-Syntax">Ctrl_ItemFocus(GuiCtrlObj, Item)
</code></pre>

<p>Applies to: <a href="ListView.htm">ListView</a>.</p>
<h3 id="ItemSelect">ItemSelect</h3>
<p>Raised when a ListView or TreeView item is selected, or a ListView item
is deselected.</p>
<pre class="codehilite"><code class="language-Syntax">ListView_ItemSelect(GuiCtrlObj, Item, Selected)
TreeView_ItemSelect(GuiCtrlObj, Item)
</code></pre>

<p>Applies to: <a href="ListView.htm">ListView</a>, <a href="TreeView.htm">TreeView</a>.</p>
<p>ListView: This event is raised once for each item being deselected or
selected, so can be raised multiple times in response to a single action
by the user.</p>
<h2 id="Other_Events">Other Events</h2>
<p>Other types of GUI events can be detected and acted upon via
<a href="GuiOnNotify.htm">OnNotify</a>, <a href="GuiOnCommand.htm">OnCommand</a> or
<a href="OnMessage.htm">OnMessage</a>. For example, a script can display
context-sensitive help via ToolTip whenever the user moves the mouse
over particular controls in the window. This is demonstrated in the <a href="Gui.htm#ExToolTip">GUI
ToolTip example</a>.</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/GuiOnEvent.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#onevent">OnEvent</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Callback_Parameters">Callback Parameters</a></li>
<li><a href="#Callback_Return_Value">Callback Return Value</a></li>
<li><a href="#Callback_Name">Callback Name</a></li>
<li><a href="#Threads">Threads</a></li>
<li><a href="#Destroying_the_GUI">Destroying the GUI</a></li>
<li><a href="#Events">Events</a></li>
<li><a href="#Window_Events">Window Events</a><ul>
<li><a href="#Close">Close</a></li>
<li><a href="#ContextMenu">ContextMenu</a></li>
<li><a href="#DropFiles">DropFiles</a></li>
<li><a href="#Escape">Escape</a></li>
<li><a href="#Size">Size</a></li>
</ul>
</li>
<li><a href="#Control_Events">Control Events</a><ul>
<li><a href="#Change">Change</a></li>
<li><a href="#Click">Click</a></li>
<li><a href="#DoubleClick">DoubleClick</a></li>
<li><a href="#ColClick">ColClick</a></li>
<li><a href="#Ctrl-ContextMenu">ContextMenu</a></li>
<li><a href="#Focus">Focus / LoseFocus</a></li>
<li><a href="#ItemCheck">ItemCheck</a></li>
<li><a href="#ItemEdit">ItemEdit</a></li>
<li><a href="#ItemExpand">ItemExpand</a></li>
<li><a href="#ItemFocus">ItemFocus</a></li>
<li><a href="#ItemSelect">ItemSelect</a></li>
</ul>
</li>
<li><a href="#Other_Events">Other Events</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script>
        // Set base URL for JavaScript modules
        window.BASE_URL = '/AHKv2_Docs';
    </script>
    <script src="/AHKv2_Docs/js/theme.js"></script>
    <script src="/AHKv2_Docs/js/sidebar.js"></script>
    <script src="/AHKv2_Docs/js/search.js"></script>
    <script src="/AHKv2_Docs/js/toc.js"></script>
    <script src="/AHKv2_Docs/js/syntax.js"></script>
</body>
</html>