<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelSearch | AutoHotkey v2 Documentation</title>
    <meta name="description" content="Searches a region of the screen for a pixel of the specified color.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/AHKv2_Docs/css/styles.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/sidebar.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/markdown.css">
    <link rel="stylesheet" href="/AHKv2_Docs/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/AHKv2_Docs/" class="navbar-brand">
                    <span class="logo-icon">âš¡</span>
                    <span class="logo-text">AutoHotkey v2</span>
                </a>
            </div>
            <div class="navbar-center">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-hint">Ctrl+K</kbd>
                </div>
            </div>
            <div class="navbar-right">
                <a href="https://github.com/012090120901209/AHKv2_Docs" class="nav-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                    <span>GitHub</span>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Search Results Dropdown -->
    <div class="search-results" id="searchResults" style="display: none;"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <!-- Category Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-book"></i>
                            <span>Getting Started</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Tutorial.html">Tutorial</a></li>
                            <li><a href="/AHKv2_Docs/FAQ.html">FAQ</a></li>
                            <li><a href="/AHKv2_Docs/Concepts.html">Concepts</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-code"></i>
                            <span>Functions</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Functions.html">Functions</a></li>
                            <li><a href="/AHKv2_Docs/StrLen.html">String Functions</a></li>
                            <li><a href="/AHKv2_Docs/WinActivate.html">Window Functions</a></li>
                            <li><a href="/AHKv2_Docs/FileRead.html">File Operations</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-cube"></i>
                            <span>Objects</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/Array.html">Array</a></li>
                            <li><a href="/AHKv2_Docs/Map.html">Map</a></li>
                            <li><a href="/AHKv2_Docs/Object.html">Object</a></li>
                            <li><a href="/AHKv2_Docs/Gui.html">Gui</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-hashtag"></i>
                            <span>Directives</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/_Include.html">#Include</a></li>
                            <li><a href="/AHKv2_Docs/_Requires.html">#Requires</a></li>
                            <li><a href="/AHKv2_Docs/_HotIf.html">#HotIf</a></li>
                        </ul>
                    </div>

                    <div class="sidebar-category">
                        <div class="category-header">
                            <i class="fas fa-info-circle"></i>
                            <span>Reference</span>
                        </div>
                        <ul class="category-items">
                            <li><a href="/AHKv2_Docs/KeyList.html">Key List</a></li>
                            <li><a href="/AHKv2_Docs/Hotkeys.html">Hotkeys</a></li>
                            <li><a href="/AHKv2_Docs/Variables.html">Variables</a></li>
                            <li><a href="/AHKv2_Docs/Language.html">Language</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/AHKv2_Docs/">Home</a> <i class="fas fa-chevron-right"></i> <span>PixelSearch</span>
                </nav>

                <!-- Document Content -->
                <article class="markdown-body">
                    <h1 id="pixelsearch">PixelSearch</h1>
<p>Searches a region of the screen for a pixel of the specified color.</p>
<pre class="codehilite"><code class="language-Syntax">PixelSearch &amp;OutputVarX, &amp;OutputVarY, X1, Y1, X2, Y2, ColorID , Variation
</code></pre>

<h2 id="Parameters">Parameters</h2>
<dl>
<dt>&amp;OutputVarX, &amp;OutputVarY</dt>
<dd>
<p>Type: <a href="../Concepts.htm#variable-references">VarRef</a></p>
<p>References to the output variables in which to store the X and Y
coordinates of the first pixel that matches <em>ColorID</em> (if no match
is found, the variables are made blank). Coordinates are relative to
the active window\'s client area unless <a href="CoordMode.htm">CoordMode</a>
was used to change that.</p>
</dd>
<dt>X1, Y1</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The X and Y coordinates of the starting corner of the rectangle to
search. Coordinates are relative to the active window\'s client area
unless <a href="CoordMode.htm">CoordMode</a> was used to change that.</p>
</dd>
<dt>X2, Y2</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The X and Y coordinates of the ending corner of the rectangle to
search. Coordinates are relative to the active window\'s client area
unless <a href="CoordMode.htm">CoordMode</a> was used to change that.</p>
</dd>
<dt>ColorID</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>The color ID to search for. This is typically expressed as a
hexadecimal number in Red-Green-Blue (RGB) format. For example:
<code>0x9d6346</code>. Color IDs can be determined using Window Spy (accessible
from the tray menu) or via <a href="PixelGetColor.htm">PixelGetColor</a>.</p>
</dd>
<dt>Variation</dt>
<dd>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>If omitted, it defaults to 0. Otherwise, specify a number between 0
and 255 (inclusive) to indicate the allowed number of shades of
variation in either direction for the intensity of the red, green,
and blue components of the color. For example, if 2 is specified and
<em>ColorID</em> is 0x444444, any color from 0x424242 to 0x464646 will be
considered a match. This parameter is helpful if the color sought is
not always exactly the same shade. If you specify 255 shades of
variation, all colors will match.</p>
</dd>
</dl>
<h2 id="Return_Value">Return Value</h2>
<p>Type: <a href="../Concepts.htm#boolean">Integer (boolean)</a></p>
<p>This function returns 1 (true) if the color was found in the specified
region, or 0 (false) if it was not found.</p>
<h2 id="Error_Handling">Error Handling</h2>
<p>An <a href="Error.htm#OSError">OSError</a> is thrown if there was a problem that
prevented the function from conducting the search.</p>
<h2 id="Remarks">Remarks</h2>
<p>The region to be searched must be visible; in other words, it is not
possible to search a region of a window hidden behind another window. By
contrast, pixels beneath the mouse cursor can usually be detected. The
exception to this is game cursors, which in most cases will obstruct any
pixels beneath them.</p>
<p>Although color depths as low as 8-bit (256-color) are supported,
PixelSearch performs much better in 24-bit or 32-bit color.</p>
<p>The search starts at the coordinates specified by <em>X1</em> and <em>Y1</em> and
checks all pixels in the row from <em>X1</em> to <em>X2</em> for a match. If no match
is found there, the search continues toward <em>Y2</em>, row by row, until it
finds a matching pixel.</p>
<p>The search order depends on the order of the parameters. In other words,
if <em>X1</em> is greater than <em>X2</em>, the search will be conducted from right to
left, starting at column <em>X1</em>. Similarly, if <em>Y1</em> is greater than <em>Y2</em>,
the search will be conducted from bottom to top.</p>
<p>If the region to be searched is large and the search is repeated with
high frequency, it may consume a lot of CPU time. To alleviate this,
keep the size of the area to a minimum.</p>
<h2 id="Related">Related</h2>
<p><a href="PixelGetColor.htm">PixelGetColor</a>, <a href="ImageSearch.htm">ImageSearch</a>,
<a href="CoordMode.htm">CoordMode</a>, <a href="MouseGetPos.htm">MouseGetPos</a></p>
<h2 id="Examples">Examples</h2>
<p>::: {#ExBasic .ex}
<a class="ex_number" href="#ExBasic"></a> Searches a region of the active window for a
pixel and stores in <em>Px</em> and <em>Py</em> the X and Y coordinates of the first
pixel that matches the specified color with 3 shades of variation.</p>
<pre class="codehilite"><code>if PixelSearch(&amp;Px, &amp;Py, 200, 200, 300, 300, 0x9d6346, 3)
    MsgBox &quot;A color within 3 shades of variation was found at X&quot; Px &quot; Y&quot; Py
else
    MsgBox &quot;That color was not found in the specified region.&quot;
</code></pre>

<p>:::</p>
                </article>

                <!-- Footer Navigation -->
                <div class="doc-pagination">
                    
                    
                </div>

                <!-- Edit on GitHub -->
                <div class="edit-page">
                    <a href="https://github.com/012090120901209/AHKv2_Docs/edit/main/PixelSearch.md" target="_blank" rel="noopener">
                        <i class="fas fa-edit"></i> Edit this page
                    </a>
                </div>
            </div>

            <!-- Table of Contents -->
            <aside class="toc">
                <div class="toc-wrapper">
                    <h3 class="toc-title">On this page</h3>
                    <nav id="tableOfContents">
                        <div class="toc">
<ul>
<li><a href="#pixelsearch">PixelSearch</a><ul>
<li><a href="#Parameters">Parameters</a></li>
<li><a href="#Return_Value">Return Value</a></li>
<li><a href="#Error_Handling">Error Handling</a></li>
<li><a href="#Remarks">Remarks</a></li>
<li><a href="#Related">Related</a></li>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
</ul>
</div>

                    </nav>
                </div>
            </aside>
        </main>
    </div>

    <!-- Scripts -->
    <script>
        // Set base URL for JavaScript modules
        window.BASE_URL = '/AHKv2_Docs';
    </script>
    <script src="/AHKv2_Docs/js/theme.js"></script>
    <script src="/AHKv2_Docs/js/sidebar.js"></script>
    <script src="/AHKv2_Docs/js/search.js"></script>
    <script src="/AHKv2_Docs/js/toc.js"></script>
    <script src="/AHKv2_Docs/js/syntax.js"></script>
</body>
</html>